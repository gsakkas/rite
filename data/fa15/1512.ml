
let rec clone x n = if n <= 0 then [] else x :: (clone x (n - 1));;

let padZero l1 l2 =
  let leng1 = List.length l1 in
  let leng2 = List.length l2 in
  let diff = leng1 - leng2 in
  if diff != 0
  then
    let zeros = clone 0 (abs diff) in
    (if diff < 0 then ((zeros @ l1), l2) else (l1, (zeros @ l2)))
  else (l1, l2);;

let rec removeZero l =
  match l with | [] -> l | h::t -> if h = 0 then removeZero t else l;;

let bigAdd l1 l2 =
  let add (l1,l2) =
    let f a x =
      match a with
      | (cin,ls) ->
          (match x with
           | (a,b) ->
               let di = (cin + a) + b in ((di / 10), ((di mod 10) :: ls))) in
    let base = (0, []) in
    let args = List.rev (List.combine l1 l2) in
    let (co,res) = List.fold_left f base args in co :: res in
  removeZero (add (padZero l1 l2));;

let rec mulByDigit i l =
  if (i = 0) || (l = [])
  then []
  else
    (let rec helper i acc l = helper (i - 1) (bigAdd acc l) l in helper i []);;


(* fix

let rec clone x n = if n <= 0 then [] else x :: (clone x (n - 1));;

let padZero l1 l2 =
  let leng1 = List.length l1 in
  let leng2 = List.length l2 in
  let diff = leng1 - leng2 in
  if diff != 0
  then
    let zeros = clone 0 (abs diff) in
    (if diff < 0 then ((zeros @ l1), l2) else (l1, (zeros @ l2)))
  else (l1, l2);;

let rec removeZero l =
  match l with | [] -> l | h::t -> if h = 0 then removeZero t else l;;

let bigAdd l1 l2 =
  let add (l1,l2) =
    let f a x =
      match a with
      | (cin,ls) ->
          (match x with
           | (a,b) ->
               let di = (cin + a) + b in ((di / 10), ((di mod 10) :: ls))) in
    let base = (0, []) in
    let args = List.rev (List.combine l1 l2) in
    let (co,res) = List.fold_left f base args in co :: res in
  removeZero (add (padZero l1 l2));;

let rec mulByDigit i l =
  if (i = 0) || (l = [])
  then []
  else
    (let rec helper i acc l = helper (i - 1) (bigAdd acc l) l in
     helper i [] l);;

*)

(* changed spans
(34,65)-(34,76)
*)

(* type error slice
(31,2)-(34,77)
(32,7)-(32,9)
(34,4)-(34,77)
(34,30)-(34,36)
(34,30)-(34,61)
(34,65)-(34,71)
(34,65)-(34,76)
*)

(* all spans
(2,14)-(2,65)
(2,16)-(2,65)
(2,20)-(2,65)
(2,23)-(2,29)
(2,23)-(2,24)
(2,28)-(2,29)
(2,35)-(2,37)
(2,43)-(2,65)
(2,43)-(2,44)
(2,48)-(2,65)
(2,49)-(2,54)
(2,55)-(2,56)
(2,57)-(2,64)
(2,58)-(2,59)
(2,62)-(2,63)
(4,12)-(12,15)
(4,15)-(12,15)
(5,2)-(12,15)
(5,14)-(5,28)
(5,14)-(5,25)
(5,26)-(5,28)
(6,2)-(12,15)
(6,14)-(6,28)
(6,14)-(6,25)
(6,26)-(6,28)
(7,2)-(12,15)
(7,13)-(7,26)
(7,13)-(7,18)
(7,21)-(7,26)
(8,2)-(12,15)
(8,5)-(8,14)
(8,5)-(8,9)
(8,13)-(8,14)
(10,4)-(11,65)
(10,16)-(10,34)
(10,16)-(10,21)
(10,22)-(10,23)
(10,24)-(10,34)
(10,25)-(10,28)
(10,29)-(10,33)
(11,4)-(11,65)
(11,8)-(11,16)
(11,8)-(11,12)
(11,15)-(11,16)
(11,22)-(11,40)
(11,23)-(11,35)
(11,30)-(11,31)
(11,24)-(11,29)
(11,32)-(11,34)
(11,37)-(11,39)
(11,46)-(11,64)
(11,47)-(11,49)
(11,51)-(11,63)
(11,58)-(11,59)
(11,52)-(11,57)
(11,60)-(11,62)
(12,7)-(12,15)
(12,8)-(12,10)
(12,12)-(12,14)
(14,19)-(15,68)
(15,2)-(15,68)
(15,8)-(15,9)
(15,23)-(15,24)
(15,35)-(15,68)
(15,38)-(15,43)
(15,38)-(15,39)
(15,42)-(15,43)
(15,49)-(15,61)
(15,49)-(15,59)
(15,60)-(15,61)
(15,67)-(15,68)
(17,11)-(28,34)
(17,14)-(28,34)
(18,2)-(28,34)
(18,11)-(27,58)
(19,4)-(27,58)
(19,10)-(24,74)
(19,12)-(24,74)
(20,6)-(24,74)
(20,12)-(20,13)
(22,10)-(24,74)
(22,17)-(22,18)
(24,15)-(24,73)
(24,24)-(24,37)
(24,24)-(24,33)
(24,25)-(24,28)
(24,31)-(24,32)
(24,36)-(24,37)
(24,41)-(24,73)
(24,42)-(24,51)
(24,43)-(24,45)
(24,48)-(24,50)
(24,53)-(24,72)
(24,54)-(24,65)
(24,55)-(24,57)
(24,62)-(24,64)
(24,69)-(24,71)
(25,4)-(27,58)
(25,15)-(25,22)
(25,16)-(25,17)
(25,19)-(25,21)
(26,4)-(27,58)
(26,15)-(26,44)
(26,15)-(26,23)
(26,24)-(26,44)
(26,25)-(26,37)
(26,38)-(26,40)
(26,41)-(26,43)
(27,4)-(27,58)
(27,19)-(27,45)
(27,19)-(27,33)
(27,34)-(27,35)
(27,36)-(27,40)
(27,41)-(27,45)
(27,49)-(27,58)
(27,49)-(27,51)
(27,55)-(27,58)
(28,2)-(28,34)
(28,2)-(28,12)
(28,13)-(28,34)
(28,14)-(28,17)
(28,18)-(28,33)
(28,19)-(28,26)
(28,27)-(28,29)
(28,30)-(28,32)
(30,19)-(34,77)
(30,21)-(34,77)
(31,2)-(34,77)
(31,5)-(31,24)
(31,5)-(31,12)
(31,6)-(31,7)
(31,10)-(31,11)
(31,16)-(31,24)
(31,17)-(31,18)
(31,21)-(31,23)
(32,7)-(32,9)
(34,4)-(34,77)
(34,20)-(34,61)
(34,22)-(34,61)
(34,26)-(34,61)
(34,30)-(34,61)
(34,30)-(34,36)
(34,37)-(34,44)
(34,38)-(34,39)
(34,42)-(34,43)
(34,45)-(34,59)
(34,46)-(34,52)
(34,53)-(34,56)
(34,57)-(34,58)
(34,60)-(34,61)
(34,65)-(34,76)
(34,65)-(34,71)
(34,72)-(34,73)
(34,74)-(34,76)
*)
