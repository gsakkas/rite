
let rec fix t x = if x = (t x) then x else t x;;

let rec wwhile (f,b) =
  match f b with | (h,t) -> if t = true then wwhile (f, h) else h;;

let fixpoint (f,b) = wwhile ((fix b), b);;


(* fix

let rec wwhile (f,b) =
  match f b with | (h,t) -> if t = true then wwhile (f, h) else h;;

let fixpoint (f,b) =
  wwhile
    ((let g b = let t = f b in if b = t then (b, false) else (t, true) in g),
      b);;

*)

(* changed spans
(2,12)-(2,46)
(2,14)-(2,46)
(2,18)-(2,46)
(2,21)-(2,22)
(2,21)-(2,30)
(2,25)-(2,30)
(2,26)-(2,27)
(2,28)-(2,29)
(2,36)-(2,37)
(2,43)-(2,44)
(2,43)-(2,46)
(2,45)-(2,46)
(7,29)-(7,36)
(7,30)-(7,33)
(7,38)-(7,39)
*)

(* type error slice
(2,3)-(2,48)
(2,12)-(2,46)
(2,14)-(2,46)
(2,43)-(2,44)
(2,43)-(2,46)
(2,45)-(2,46)
(4,3)-(5,67)
(4,16)-(5,65)
(5,8)-(5,9)
(5,8)-(5,11)
(5,10)-(5,11)
(7,21)-(7,27)
(7,21)-(7,40)
(7,28)-(7,40)
(7,29)-(7,36)
(7,30)-(7,33)
(7,34)-(7,35)
(7,38)-(7,39)
*)

(* all spans
(2,12)-(2,46)
(2,14)-(2,46)
(2,18)-(2,46)
(2,21)-(2,30)
(2,21)-(2,22)
(2,25)-(2,30)
(2,26)-(2,27)
(2,28)-(2,29)
(2,36)-(2,37)
(2,43)-(2,46)
(2,43)-(2,44)
(2,45)-(2,46)
(4,16)-(5,65)
(5,2)-(5,65)
(5,8)-(5,11)
(5,8)-(5,9)
(5,10)-(5,11)
(5,28)-(5,65)
(5,31)-(5,39)
(5,31)-(5,32)
(5,35)-(5,39)
(5,45)-(5,58)
(5,45)-(5,51)
(5,52)-(5,58)
(5,53)-(5,54)
(5,56)-(5,57)
(5,64)-(5,65)
(7,14)-(7,40)
(7,21)-(7,40)
(7,21)-(7,27)
(7,28)-(7,40)
(7,29)-(7,36)
(7,30)-(7,33)
(7,34)-(7,35)
(7,38)-(7,39)
*)
