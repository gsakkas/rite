
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | NewOp1 of expr* expr* expr
  | NewOp2 of expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine e1 -> "sin(pi*" ^ ((exprToString e1) ^ ")")
  | Cosine e1 -> "cos(pi*" ^ ((exprToString e1) ^ ")")
  | Average (e1,e2) ->
      "((" ^
        ((exprToString e1) ^ ("+" ^ ((exprToString e2) ^ (")" ^ "/2)"))))
  | Times (e1,e2) -> (exprToString e1) ^ ("*" ^ (exprToString e2))
  | Thresh (e1,e2,e3,e4) ->
      "(" ^
        ((exprToString e1) ^
           ("<" ^
              ((exprToString e2) ^
                 ("?" ^
                    ((exprToString e3) ^ (":" ^ ((exprToString e4) ^ ")")))))))
  | NewOp1 (e1,e2,e3) ->
      ("(" "1/sin(pi*") ^
        ((exprToString e1) ^
           (")" ^
              ("cos(pi*" ^
                 ((exprToString e1) ^
                    (")" ^ ("sin(pi*" ^ ((exprToString e1) ^ (")" ^ ")"))))))))
  | NewOp2 e1 -> "1/sin(pi*" ^ ((exprToString e1) ^ ")");;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | NewOp1 of expr* expr* expr
  | NewOp2 of expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine e1 -> "sin(pi*" ^ ((exprToString e1) ^ ")")
  | Cosine e1 -> "cos(pi*" ^ ((exprToString e1) ^ ")")
  | Average (e1,e2) ->
      "((" ^
        ((exprToString e1) ^ ("+" ^ ((exprToString e2) ^ (")" ^ "/2)"))))
  | Times (e1,e2) -> (exprToString e1) ^ ("*" ^ (exprToString e2))
  | Thresh (e1,e2,e3,e4) ->
      "(" ^
        ((exprToString e1) ^
           ("<" ^
              ((exprToString e2) ^
                 ("?" ^
                    ((exprToString e3) ^ (":" ^ ((exprToString e4) ^ ")")))))))
  | NewOp1 (e1,e2,e3) ->
      "(" ^
        ("1/sin(pi*" ^
           ((exprToString e1) ^
              (")" ^
                 ("cos(pi*" ^
                    ((exprToString e1) ^
                       (")" ^ ("sin(pi*" ^ ((exprToString e1) ^ (")" ^ ")")))))))))
  | NewOp2 e1 -> "1/sin(pi*" ^ ((exprToString e1) ^ ")");;

*)

(* changed spans
(31,6)-(31,23)
(31,11)-(31,22)
*)

(* type error slice
(31,6)-(31,23)
(31,7)-(31,10)
*)

(* all spans
(13,21)-(37,56)
(14,2)-(37,56)
(14,8)-(14,9)
(15,13)-(15,16)
(16,13)-(16,16)
(17,15)-(17,52)
(17,25)-(17,26)
(17,15)-(17,24)
(17,27)-(17,52)
(17,46)-(17,47)
(17,28)-(17,45)
(17,29)-(17,41)
(17,42)-(17,44)
(17,48)-(17,51)
(18,17)-(18,54)
(18,27)-(18,28)
(18,17)-(18,26)
(18,29)-(18,54)
(18,48)-(18,49)
(18,30)-(18,47)
(18,31)-(18,43)
(18,44)-(18,46)
(18,50)-(18,53)
(20,6)-(21,73)
(20,11)-(20,12)
(20,6)-(20,10)
(21,8)-(21,73)
(21,27)-(21,28)
(21,9)-(21,26)
(21,10)-(21,22)
(21,23)-(21,25)
(21,29)-(21,72)
(21,34)-(21,35)
(21,30)-(21,33)
(21,36)-(21,71)
(21,55)-(21,56)
(21,37)-(21,54)
(21,38)-(21,50)
(21,51)-(21,53)
(21,57)-(21,70)
(21,62)-(21,63)
(21,58)-(21,61)
(21,64)-(21,69)
(22,21)-(22,66)
(22,39)-(22,40)
(22,21)-(22,38)
(22,22)-(22,34)
(22,35)-(22,37)
(22,41)-(22,66)
(22,46)-(22,47)
(22,42)-(22,45)
(22,48)-(22,65)
(22,49)-(22,61)
(22,62)-(22,64)
(24,6)-(29,79)
(24,10)-(24,11)
(24,6)-(24,9)
(25,8)-(29,79)
(25,27)-(25,28)
(25,9)-(25,26)
(25,10)-(25,22)
(25,23)-(25,25)
(26,11)-(29,78)
(26,16)-(26,17)
(26,12)-(26,15)
(27,14)-(29,77)
(27,33)-(27,34)
(27,15)-(27,32)
(27,16)-(27,28)
(27,29)-(27,31)
(28,17)-(29,76)
(28,22)-(28,23)
(28,18)-(28,21)
(29,20)-(29,75)
(29,39)-(29,40)
(29,21)-(29,38)
(29,22)-(29,34)
(29,35)-(29,37)
(29,41)-(29,74)
(29,46)-(29,47)
(29,42)-(29,45)
(29,48)-(29,73)
(29,67)-(29,68)
(29,49)-(29,66)
(29,50)-(29,62)
(29,63)-(29,65)
(29,69)-(29,72)
(31,6)-(36,79)
(31,24)-(31,25)
(31,6)-(31,23)
(31,7)-(31,10)
(31,11)-(31,22)
(32,8)-(36,79)
(32,27)-(32,28)
(32,9)-(32,26)
(32,10)-(32,22)
(32,23)-(32,25)
(33,11)-(36,78)
(33,16)-(33,17)
(33,12)-(33,15)
(34,14)-(36,77)
(34,25)-(34,26)
(34,15)-(34,24)
(35,17)-(36,76)
(35,36)-(35,37)
(35,18)-(35,35)
(35,19)-(35,31)
(35,32)-(35,34)
(36,20)-(36,75)
(36,25)-(36,26)
(36,21)-(36,24)
(36,27)-(36,74)
(36,38)-(36,39)
(36,28)-(36,37)
(36,40)-(36,73)
(36,59)-(36,60)
(36,41)-(36,58)
(36,42)-(36,54)
(36,55)-(36,57)
(36,61)-(36,72)
(36,66)-(36,67)
(36,62)-(36,65)
(36,68)-(36,71)
(37,17)-(37,56)
(37,29)-(37,30)
(37,17)-(37,28)
(37,31)-(37,56)
(37,50)-(37,51)
(37,32)-(37,49)
(37,33)-(37,45)
(37,46)-(37,48)
(37,52)-(37,55)
*)
