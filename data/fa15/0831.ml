
let modulus ss = ss mod 10;;

let rec digitsOfInt n =
  if n <= 0
  then []
  else (match n with | x -> (digitsOfInt (n / 10)) @ [modulus x]);;

let lt10 q = q < 10;;

let rec sumList xs = match xs with | [] -> 0 | h::t -> h + (sumList t);;

let rec additivePersistence n =
  if lt10 n
  then n
  else
    (match n with
     | n ->
         let x_ = digitsOfInt n in
         (sumList x_) = (let xx = sumList x_ in additivePersistence xx));;


(* fix

let modulus ss = ss mod 10;;

let rec digitsOfInt n =
  if n <= 0
  then []
  else (match n with | x -> (digitsOfInt (n / 10)) @ [modulus x]);;

let lt10 q = q < 10;;

let rec sumList xs = match xs with | [] -> 0 | h::t -> h + (sumList t);;

let rec additivePersistence n =
  if lt10 n
  then n
  else
    (match n with
     | n ->
         let n1 = let x0 = digitsOfInt n in sumList x0 in
         additivePersistence n1);;

*)

(* changed spans
(19,9)-(20,71)
(19,18)-(19,31)
(20,9)-(20,71)
(20,18)-(20,20)
(20,24)-(20,71)
(20,34)-(20,41)
(20,34)-(20,44)
(20,42)-(20,44)
(20,68)-(20,70)
*)

(* type error slice
(9,3)-(9,21)
(9,9)-(9,19)
(9,13)-(9,14)
(9,13)-(9,19)
(9,17)-(9,19)
(11,55)-(11,70)
(11,59)-(11,70)
(11,60)-(11,67)
(13,3)-(20,74)
(13,28)-(20,72)
(14,2)-(20,72)
(14,5)-(14,9)
(14,5)-(14,11)
(14,10)-(14,11)
(15,7)-(15,8)
(17,4)-(20,72)
(19,9)-(20,71)
(20,9)-(20,71)
(20,24)-(20,71)
(20,34)-(20,41)
(20,34)-(20,44)
(20,48)-(20,67)
(20,48)-(20,70)
(20,68)-(20,70)
*)

(* all spans
(2,12)-(2,26)
(2,17)-(2,26)
(2,17)-(2,19)
(2,24)-(2,26)
(4,20)-(7,65)
(5,2)-(7,65)
(5,5)-(5,11)
(5,5)-(5,6)
(5,10)-(5,11)
(6,7)-(6,9)
(7,7)-(7,65)
(7,14)-(7,15)
(7,28)-(7,64)
(7,51)-(7,52)
(7,28)-(7,50)
(7,29)-(7,40)
(7,41)-(7,49)
(7,42)-(7,43)
(7,46)-(7,48)
(7,53)-(7,64)
(7,54)-(7,63)
(7,54)-(7,61)
(7,62)-(7,63)
(9,9)-(9,19)
(9,13)-(9,19)
(9,13)-(9,14)
(9,17)-(9,19)
(11,16)-(11,70)
(11,21)-(11,70)
(11,27)-(11,29)
(11,43)-(11,44)
(11,55)-(11,70)
(11,55)-(11,56)
(11,59)-(11,70)
(11,60)-(11,67)
(11,68)-(11,69)
(13,28)-(20,72)
(14,2)-(20,72)
(14,5)-(14,11)
(14,5)-(14,9)
(14,10)-(14,11)
(15,7)-(15,8)
(17,4)-(20,72)
(17,11)-(17,12)
(19,9)-(20,71)
(19,18)-(19,31)
(19,18)-(19,29)
(19,30)-(19,31)
(20,9)-(20,71)
(20,9)-(20,21)
(20,10)-(20,17)
(20,18)-(20,20)
(20,24)-(20,71)
(20,34)-(20,44)
(20,34)-(20,41)
(20,42)-(20,44)
(20,48)-(20,70)
(20,48)-(20,67)
(20,68)-(20,70)
*)
