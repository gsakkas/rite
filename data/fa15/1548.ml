
let f' (f,b) = (f b) = b;;

let rec wwhile (f,b) =
  match f b with | (h1,h2) -> if h2 then wwhile (f, h1) else h1;;

let fixpoint (f,b) =
  wwhile
    ((let f' x = if (f x) = b then (b, true) else ((f' x), false) in f' 1),
      b);;


(* fix

let rec wwhile (f,b) =
  match f b with | (h1,h2) -> if h2 then wwhile (f, h1) else h1;;

let fixpoint (f,b) =
  wwhile
    ((let f' x = if (f x) = b then (b, true) else ((f x), false) in f'), b);;

*)

(* changed spans
(2,15)-(2,20)
(2,15)-(2,24)
(2,16)-(2,17)
(2,18)-(2,19)
(2,23)-(2,24)
(4,16)-(5,63)
(9,52)-(9,54)
(9,69)-(9,73)
(9,72)-(9,73)
*)

(* type error slice
(2,3)-(2,26)
(2,8)-(2,24)
(9,5)-(9,74)
(9,13)-(9,65)
(9,51)-(9,57)
(9,52)-(9,54)
(9,55)-(9,56)
(9,69)-(9,71)
(9,69)-(9,73)
(9,72)-(9,73)
*)

(* all spans
(2,8)-(2,24)
(2,15)-(2,24)
(2,15)-(2,20)
(2,16)-(2,17)
(2,18)-(2,19)
(2,23)-(2,24)
(4,16)-(5,63)
(5,2)-(5,63)
(5,8)-(5,11)
(5,8)-(5,9)
(5,10)-(5,11)
(5,30)-(5,63)
(5,33)-(5,35)
(5,41)-(5,55)
(5,41)-(5,47)
(5,48)-(5,55)
(5,49)-(5,50)
(5,52)-(5,54)
(5,61)-(5,63)
(7,14)-(10,8)
(8,2)-(10,8)
(8,2)-(8,8)
(9,4)-(10,8)
(9,5)-(9,74)
(9,13)-(9,65)
(9,17)-(9,65)
(9,20)-(9,29)
(9,20)-(9,25)
(9,21)-(9,22)
(9,23)-(9,24)
(9,28)-(9,29)
(9,35)-(9,44)
(9,36)-(9,37)
(9,39)-(9,43)
(9,50)-(9,65)
(9,51)-(9,57)
(9,52)-(9,54)
(9,55)-(9,56)
(9,59)-(9,64)
(9,69)-(9,73)
(9,69)-(9,71)
(9,72)-(9,73)
(10,6)-(10,7)
*)
