
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | TimesTimes of expr* expr* expr
  | Cube of expr
  | MultDivBy6 of expr* expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine e1 -> "sin (pi*" ^ ((exprToString e1) ^ ")")
  | Cosine e1 -> "cos (pi*" ^ ((exprToString e1) ^ ")")
  | Average (e1,e2) ->
      "((" ^ ((exprToString e1) ^ (" + " ^ ((exprToString e2) ^ ")/2)")))
  | Times (e1,e2) -> (exprToString e1) ^ (" * " ^ (exprToString e2))
  | Thresh (e1,e2,e3,e4) ->
      "(" ^
        ((exprToString e1) ^
           ("<" ^
              ((exprToString e2) ^
                 (" ? " ^
                    ((exprToString e3) ^ (" : " ^ ((exprToString e4) ^ ")")))))))
  | TimesTimes (e1,e2,e3) ->
      (exprToString e1) ^
        (" * " ^ ((exprToString e2) ^ (" * " ^ (exprToString e3))))
  | Cube e1 ->
      (exprToString e1) ^
        (" * " ^ ((exprToString e1) ^ (" * " ^ (exprToString e1))))
  | MultDivBy6 (e1,e2) ->
      ("((" (exprToString e1)) ^ (" * " ^ ((exprToString e2) ^ ") /6)"));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | TimesTimes of expr* expr* expr
  | Cube of expr
  | MultDivBy6 of expr* expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine e1 -> "sin (pi*" ^ ((exprToString e1) ^ ")")
  | Cosine e1 -> "cos (pi*" ^ ((exprToString e1) ^ ")")
  | Average (e1,e2) ->
      "((" ^ ((exprToString e1) ^ (" + " ^ ((exprToString e2) ^ ")/2)")))
  | Times (e1,e2) -> (exprToString e1) ^ (" * " ^ (exprToString e2))
  | Thresh (e1,e2,e3,e4) ->
      "(" ^
        ((exprToString e1) ^
           ("<" ^
              ((exprToString e2) ^
                 (" ? " ^
                    ((exprToString e3) ^ (" : " ^ ((exprToString e4) ^ ")")))))))
  | TimesTimes (e1,e2,e3) ->
      (exprToString e1) ^
        (" * " ^ ((exprToString e2) ^ (" * " ^ (exprToString e3))))
  | Cube e1 ->
      (exprToString e1) ^
        (" * " ^ ((exprToString e1) ^ (" * " ^ (exprToString e1))))
  | MultDivBy6 (e1,e2) ->
      "((" ^ ((exprToString e1) ^ (" * " ^ ((exprToString e2) ^ ") /6)")));;

*)

(* changed spans
(37,6)-(37,30)
(37,12)-(37,29)
*)

(* type error slice
(37,6)-(37,30)
(37,7)-(37,11)
*)

(* all spans
(14,21)-(37,72)
(15,2)-(37,72)
(15,8)-(15,9)
(16,13)-(16,16)
(17,13)-(17,16)
(18,15)-(18,53)
(18,26)-(18,27)
(18,15)-(18,25)
(18,28)-(18,53)
(18,47)-(18,48)
(18,29)-(18,46)
(18,30)-(18,42)
(18,43)-(18,45)
(18,49)-(18,52)
(19,17)-(19,55)
(19,28)-(19,29)
(19,17)-(19,27)
(19,30)-(19,55)
(19,49)-(19,50)
(19,31)-(19,48)
(19,32)-(19,44)
(19,45)-(19,47)
(19,51)-(19,54)
(21,6)-(21,73)
(21,11)-(21,12)
(21,6)-(21,10)
(21,13)-(21,73)
(21,32)-(21,33)
(21,14)-(21,31)
(21,15)-(21,27)
(21,28)-(21,30)
(21,34)-(21,72)
(21,41)-(21,42)
(21,35)-(21,40)
(21,43)-(21,71)
(21,62)-(21,63)
(21,44)-(21,61)
(21,45)-(21,57)
(21,58)-(21,60)
(21,64)-(21,70)
(22,21)-(22,68)
(22,39)-(22,40)
(22,21)-(22,38)
(22,22)-(22,34)
(22,35)-(22,37)
(22,41)-(22,68)
(22,48)-(22,49)
(22,42)-(22,47)
(22,50)-(22,67)
(22,51)-(22,63)
(22,64)-(22,66)
(24,6)-(29,81)
(24,10)-(24,11)
(24,6)-(24,9)
(25,8)-(29,81)
(25,27)-(25,28)
(25,9)-(25,26)
(25,10)-(25,22)
(25,23)-(25,25)
(26,11)-(29,80)
(26,16)-(26,17)
(26,12)-(26,15)
(27,14)-(29,79)
(27,33)-(27,34)
(27,15)-(27,32)
(27,16)-(27,28)
(27,29)-(27,31)
(28,17)-(29,78)
(28,24)-(28,25)
(28,18)-(28,23)
(29,20)-(29,77)
(29,39)-(29,40)
(29,21)-(29,38)
(29,22)-(29,34)
(29,35)-(29,37)
(29,41)-(29,76)
(29,48)-(29,49)
(29,42)-(29,47)
(29,50)-(29,75)
(29,69)-(29,70)
(29,51)-(29,68)
(29,52)-(29,64)
(29,65)-(29,67)
(29,71)-(29,74)
(31,6)-(32,67)
(31,24)-(31,25)
(31,6)-(31,23)
(31,7)-(31,19)
(31,20)-(31,22)
(32,8)-(32,67)
(32,15)-(32,16)
(32,9)-(32,14)
(32,17)-(32,66)
(32,36)-(32,37)
(32,18)-(32,35)
(32,19)-(32,31)
(32,32)-(32,34)
(32,38)-(32,65)
(32,45)-(32,46)
(32,39)-(32,44)
(32,47)-(32,64)
(32,48)-(32,60)
(32,61)-(32,63)
(34,6)-(35,67)
(34,24)-(34,25)
(34,6)-(34,23)
(34,7)-(34,19)
(34,20)-(34,22)
(35,8)-(35,67)
(35,15)-(35,16)
(35,9)-(35,14)
(35,17)-(35,66)
(35,36)-(35,37)
(35,18)-(35,35)
(35,19)-(35,31)
(35,32)-(35,34)
(35,38)-(35,65)
(35,45)-(35,46)
(35,39)-(35,44)
(35,47)-(35,64)
(35,48)-(35,60)
(35,61)-(35,63)
(37,6)-(37,72)
(37,31)-(37,32)
(37,6)-(37,30)
(37,7)-(37,11)
(37,12)-(37,29)
(37,13)-(37,25)
(37,26)-(37,28)
(37,33)-(37,72)
(37,40)-(37,41)
(37,34)-(37,39)
(37,42)-(37,71)
(37,61)-(37,62)
(37,43)-(37,60)
(37,44)-(37,56)
(37,57)-(37,59)
(37,63)-(37,70)
*)
