
let rec digitsOfInt n =
  if n < 0
  then []
  else
    (let a = n mod 10 in
     let b = n / 10 in
     match b with
     | 0 -> if a = 0 then [] else (digitsOfInt b) @ [a]
     | x -> (digitsOfInt b) @ [a]);;

let digits n = digitsOfInt (abs n);;

let rec sumList xs = match xs with | [] -> 0 | h::t -> h + (sumList t);;

let oneRoot n =
  let y = sumList (digits n) in
  match y / 10 with | 0 -> if (y mod 10) = 0 then 0 else y | z -> y;;

let rec addHelp (n,m) =
  let y = oneRoot n in
  match y / 10 with | 0 -> m + 1 | z -> addHelp (y, (m + 1));;

let rec additivePersistence n = if n / 10 then 0 else addHelp (n, 0);;


(* fix

let rec digitsOfInt n =
  if n < 0
  then []
  else
    (let a = n mod 10 in
     let b = n / 10 in
     match b with
     | 0 -> if a = 0 then [] else (digitsOfInt b) @ [a]
     | x -> (digitsOfInt b) @ [a]);;

let digits n = digitsOfInt (abs n);;

let rec sumList xs = match xs with | [] -> 0 | h::t -> h + (sumList t);;

let oneRoot n =
  let y = sumList (digits n) in
  match y / 10 with | 0 -> if (y mod 10) = 0 then 0 else y | z -> y;;

let rec addHelp (n,m) =
  let y = oneRoot n in
  match y / 10 with | 0 -> m + 1 | z -> addHelp (y, (m + 1));;

let rec additivePersistence n = if (n / 10) = 0 then 0 else addHelp (n, 0);;

*)

(* changed spans
(24,35)-(24,41)
(24,54)-(24,68)
*)

(* type error slice
(24,32)-(24,68)
(24,35)-(24,41)
*)

(* all spans
(2,20)-(10,34)
(3,2)-(10,34)
(3,5)-(3,10)
(3,5)-(3,6)
(3,9)-(3,10)
(4,7)-(4,9)
(6,4)-(10,34)
(6,13)-(6,21)
(6,13)-(6,14)
(6,19)-(6,21)
(7,5)-(10,33)
(7,13)-(7,19)
(7,13)-(7,14)
(7,17)-(7,19)
(8,5)-(10,33)
(8,11)-(8,12)
(9,12)-(9,55)
(9,15)-(9,20)
(9,15)-(9,16)
(9,19)-(9,20)
(9,26)-(9,28)
(9,34)-(9,55)
(9,50)-(9,51)
(9,34)-(9,49)
(9,35)-(9,46)
(9,47)-(9,48)
(9,52)-(9,55)
(9,53)-(9,54)
(10,12)-(10,33)
(10,28)-(10,29)
(10,12)-(10,27)
(10,13)-(10,24)
(10,25)-(10,26)
(10,30)-(10,33)
(10,31)-(10,32)
(12,11)-(12,34)
(12,15)-(12,34)
(12,15)-(12,26)
(12,27)-(12,34)
(12,28)-(12,31)
(12,32)-(12,33)
(14,16)-(14,70)
(14,21)-(14,70)
(14,27)-(14,29)
(14,43)-(14,44)
(14,55)-(14,70)
(14,55)-(14,56)
(14,59)-(14,70)
(14,60)-(14,67)
(14,68)-(14,69)
(16,12)-(18,67)
(17,2)-(18,67)
(17,10)-(17,28)
(17,10)-(17,17)
(17,18)-(17,28)
(17,19)-(17,25)
(17,26)-(17,27)
(18,2)-(18,67)
(18,8)-(18,14)
(18,8)-(18,9)
(18,12)-(18,14)
(18,27)-(18,58)
(18,30)-(18,44)
(18,30)-(18,40)
(18,31)-(18,32)
(18,37)-(18,39)
(18,43)-(18,44)
(18,50)-(18,51)
(18,57)-(18,58)
(18,66)-(18,67)
(20,17)-(22,60)
(21,2)-(22,60)
(21,10)-(21,19)
(21,10)-(21,17)
(21,18)-(21,19)
(22,2)-(22,60)
(22,8)-(22,14)
(22,8)-(22,9)
(22,12)-(22,14)
(22,27)-(22,32)
(22,27)-(22,28)
(22,31)-(22,32)
(22,40)-(22,60)
(22,40)-(22,47)
(22,48)-(22,60)
(22,49)-(22,50)
(22,52)-(22,59)
(22,53)-(22,54)
(22,57)-(22,58)
(24,28)-(24,68)
(24,32)-(24,68)
(24,35)-(24,41)
(24,35)-(24,36)
(24,39)-(24,41)
(24,47)-(24,48)
(24,54)-(24,68)
(24,54)-(24,61)
(24,62)-(24,68)
(24,63)-(24,64)
(24,66)-(24,67)
*)
