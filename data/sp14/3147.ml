
let l1 = [0; 0; 9; 9];;

let l2 = [1; 0; 0; 2];;

let x = (3, 3) :: (List.rev (List.combine l1 l2));;

let clone x n =
  let rec helper x n acc =
    if n <= 0 then acc else helper x (n - 1) (x :: acc) in
  helper x n [];;

let padZero l1 l2 =
  if (List.length l1) < (List.length l2)
  then ((List.append (clone 0 ((List.length l2) - (List.length l1))) l1), l2)
  else (l1, (List.append (clone 0 ((List.length l1) - (List.length l2))) l2));;

let rec removeZero l =
  match l with | [] -> [] | x::xs -> if x = 0 then removeZero xs else x :: xs;;

let bigAdd l1 l2 =
  let add (l1,l2) =
    let f a x =
      match a with
      | (c,(d1,d2)::ds) -> ((d1 + (d2 mod 10)), ((d1 + d2) :: x)) in
    let base = (0, []) in
    let args = List.rev (List.combine l1 l2) in
    let (_,res) = List.fold_left f base args in res in
  removeZero (add (padZero l1 l2));;


(* fix

let l1 = [0; 0; 9; 9];;

let l2 = [1; 0; 0; 2];;

let x = (3, 3) :: (List.rev (List.combine l1 l2));;

let clone x n =
  let rec helper x n acc =
    if n <= 0 then acc else helper x (n - 1) (x :: acc) in
  helper x n [];;

let padZero l1 l2 =
  if (List.length l1) < (List.length l2)
  then ((List.append (clone 0 ((List.length l2) - (List.length l1))) l1), l2)
  else (l1, (List.append (clone 0 ((List.length l1) - (List.length l2))) l2));;

let rec removeZero l =
  match l with | [] -> [] | x::xs -> if x = 0 then removeZero xs else x :: xs;;

let bigAdd l1 l2 =
  let add (l1,l2) =
    let f a x =
      match x with
      | (d1,d2) ->
          ((d1 + d2), ((d1 + d2) :: ((match a with | (a1,a2) -> a2)))) in
    let base = (0, []) in
    let args = List.rev (List.combine l1 l2) in
    let (_,res) = List.fold_left f base args in res in
  removeZero (add (padZero l1 l2));;

*)

(* changed spans
(24,6)-(25,65)
(24,12)-(24,13)
(25,27)-(25,65)
(25,34)-(25,45)
(25,42)-(25,44)
(25,62)-(25,63)
(26,4)-(28,51)
*)

(* type error slice
(23,4)-(28,51)
(23,10)-(25,65)
(23,12)-(25,65)
(24,6)-(25,65)
(24,12)-(24,13)
(25,27)-(25,65)
(25,48)-(25,64)
(25,49)-(25,58)
(28,18)-(28,32)
(28,18)-(28,44)
(28,33)-(28,34)
*)

(* all spans
(2,9)-(2,21)
(2,10)-(2,11)
(2,13)-(2,14)
(2,16)-(2,17)
(2,19)-(2,20)
(4,9)-(4,21)
(4,10)-(4,11)
(4,13)-(4,14)
(4,16)-(4,17)
(4,19)-(4,20)
(6,8)-(6,49)
(6,8)-(6,14)
(6,9)-(6,10)
(6,12)-(6,13)
(6,18)-(6,49)
(6,19)-(6,27)
(6,28)-(6,48)
(6,29)-(6,41)
(6,42)-(6,44)
(6,45)-(6,47)
(8,10)-(11,15)
(8,12)-(11,15)
(9,2)-(11,15)
(9,17)-(10,55)
(9,19)-(10,55)
(9,21)-(10,55)
(10,4)-(10,55)
(10,7)-(10,13)
(10,7)-(10,8)
(10,12)-(10,13)
(10,19)-(10,22)
(10,28)-(10,55)
(10,28)-(10,34)
(10,35)-(10,36)
(10,37)-(10,44)
(10,38)-(10,39)
(10,42)-(10,43)
(10,45)-(10,55)
(10,46)-(10,47)
(10,51)-(10,54)
(11,2)-(11,15)
(11,2)-(11,8)
(11,9)-(11,10)
(11,11)-(11,12)
(11,13)-(11,15)
(13,12)-(16,77)
(13,15)-(16,77)
(14,2)-(16,77)
(14,5)-(14,40)
(14,5)-(14,21)
(14,6)-(14,17)
(14,18)-(14,20)
(14,24)-(14,40)
(14,25)-(14,36)
(14,37)-(14,39)
(15,7)-(15,77)
(15,8)-(15,72)
(15,9)-(15,20)
(15,21)-(15,68)
(15,22)-(15,27)
(15,28)-(15,29)
(15,30)-(15,67)
(15,31)-(15,47)
(15,32)-(15,43)
(15,44)-(15,46)
(15,50)-(15,66)
(15,51)-(15,62)
(15,63)-(15,65)
(15,69)-(15,71)
(15,74)-(15,76)
(16,7)-(16,77)
(16,8)-(16,10)
(16,12)-(16,76)
(16,13)-(16,24)
(16,25)-(16,72)
(16,26)-(16,31)
(16,32)-(16,33)
(16,34)-(16,71)
(16,35)-(16,51)
(16,36)-(16,47)
(16,48)-(16,50)
(16,54)-(16,70)
(16,55)-(16,66)
(16,67)-(16,69)
(16,73)-(16,75)
(18,19)-(19,77)
(19,2)-(19,77)
(19,8)-(19,9)
(19,23)-(19,25)
(19,37)-(19,77)
(19,40)-(19,45)
(19,40)-(19,41)
(19,44)-(19,45)
(19,51)-(19,64)
(19,51)-(19,61)
(19,62)-(19,64)
(19,70)-(19,77)
(19,70)-(19,71)
(19,75)-(19,77)
(21,11)-(29,34)
(21,14)-(29,34)
(22,2)-(29,34)
(22,11)-(28,51)
(23,4)-(28,51)
(23,10)-(25,65)
(23,12)-(25,65)
(24,6)-(25,65)
(24,12)-(24,13)
(25,27)-(25,65)
(25,28)-(25,46)
(25,29)-(25,31)
(25,34)-(25,45)
(25,35)-(25,37)
(25,42)-(25,44)
(25,48)-(25,64)
(25,49)-(25,58)
(25,50)-(25,52)
(25,55)-(25,57)
(25,62)-(25,63)
(26,4)-(28,51)
(26,15)-(26,22)
(26,16)-(26,17)
(26,19)-(26,21)
(27,4)-(28,51)
(27,15)-(27,44)
(27,15)-(27,23)
(27,24)-(27,44)
(27,25)-(27,37)
(27,38)-(27,40)
(27,41)-(27,43)
(28,4)-(28,51)
(28,18)-(28,44)
(28,18)-(28,32)
(28,33)-(28,34)
(28,35)-(28,39)
(28,40)-(28,44)
(28,48)-(28,51)
(29,2)-(29,34)
(29,2)-(29,12)
(29,13)-(29,34)
(29,14)-(29,17)
(29,18)-(29,33)
(29,19)-(29,26)
(29,27)-(29,29)
(29,30)-(29,32)
*)
