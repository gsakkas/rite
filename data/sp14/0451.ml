
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Percent of expr
  | Negate of expr
  | SumSquared of expr* expr* expr;;

let pi = 4.0 *. (atan 1.0);;

let rec eval (e,x,y) =
  match e with
  | VarX  -> x
  | VarY  -> y
  | Sine e1 -> sin (pi *. (eval (e1, x, y)))
  | Cosine e1 -> cos (pi *. (eval (e1, x, y)))
  | Average (e1,e2) -> ((eval (e1, x, y)) +. (eval (e2, x, y))) /. 2.0
  | Times (e1,e2) -> (eval (e1, x, y)) *. (eval (e2, x, y))
  | Thresh (a,b,a_less,b_less) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then eval (a_less, x, y)
      else eval (b_less, x, y)
  | Percent e1 -> (eval (e1, x, y)) *. 0.01
  | Negate e1 -> (eval (e1, x, y)) *. (-1.0)
  | SumSquared (e1,e2,e3) ->
      (((eval (e1, x, y)) * (eval (e1, x, y))) +
         ((eval (e2, x, y)) * (eval (e2, x, y))))
        + ((eval (e3, x, y)) * (eval (e3, x, y)));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Percent of expr
  | Negate of expr
  | SumSquared of expr* expr* expr;;

let pi = 4.0 *. (atan 1.0);;

let rec eval (e,x,y) =
  match e with
  | VarX  -> x
  | VarY  -> y
  | Sine e1 -> sin (pi *. (eval (e1, x, y)))
  | Cosine e1 -> cos (pi *. (eval (e1, x, y)))
  | Average (e1,e2) -> ((eval (e1, x, y)) +. (eval (e2, x, y))) /. 2.0
  | Times (e1,e2) -> (eval (e1, x, y)) *. (eval (e2, x, y))
  | Thresh (a,b,a_less,b_less) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then eval (a_less, x, y)
      else eval (b_less, x, y)
  | Percent e1 -> (eval (e1, x, y)) *. 0.01
  | Negate e1 -> (eval (e1, x, y)) *. (-1.0)
  | SumSquared (e1,e2,e3) ->
      (((eval (e1, x, y)) *. (eval (e1, x, y))) +.
         ((eval (e2, x, y)) *. (eval (e2, x, y))))
        +. ((eval (e3, x, y)) *. (eval (e3, x, y)));;

*)

(* changed spans
(31,6)-(32,49)
(31,6)-(33,49)
(31,7)-(31,46)
(31,8)-(31,25)
(32,9)-(32,48)
(33,10)-(33,49)
*)

(* type error slice
(20,19)-(20,44)
(20,26)-(20,43)
(20,27)-(20,31)
(29,17)-(29,44)
(29,38)-(29,44)
(29,40)-(29,43)
(31,7)-(31,46)
(31,8)-(31,25)
(31,9)-(31,13)
(31,28)-(31,45)
(31,29)-(31,33)
(32,9)-(32,48)
(32,10)-(32,27)
(32,11)-(32,15)
(32,30)-(32,47)
(32,31)-(32,35)
(33,10)-(33,49)
(33,11)-(33,28)
(33,12)-(33,16)
(33,31)-(33,48)
(33,32)-(33,36)
*)

(* all spans
(14,9)-(14,26)
(14,9)-(14,12)
(14,16)-(14,26)
(14,17)-(14,21)
(14,22)-(14,25)
(16,14)-(33,49)
(17,2)-(33,49)
(17,8)-(17,9)
(18,13)-(18,14)
(19,13)-(19,14)
(20,15)-(20,44)
(20,15)-(20,18)
(20,19)-(20,44)
(20,20)-(20,22)
(20,26)-(20,43)
(20,27)-(20,31)
(20,32)-(20,42)
(20,33)-(20,35)
(20,37)-(20,38)
(20,40)-(20,41)
(21,17)-(21,46)
(21,17)-(21,20)
(21,21)-(21,46)
(21,22)-(21,24)
(21,28)-(21,45)
(21,29)-(21,33)
(21,34)-(21,44)
(21,35)-(21,37)
(21,39)-(21,40)
(21,42)-(21,43)
(22,23)-(22,70)
(22,23)-(22,63)
(22,24)-(22,41)
(22,25)-(22,29)
(22,30)-(22,40)
(22,31)-(22,33)
(22,35)-(22,36)
(22,38)-(22,39)
(22,45)-(22,62)
(22,46)-(22,50)
(22,51)-(22,61)
(22,52)-(22,54)
(22,56)-(22,57)
(22,59)-(22,60)
(22,67)-(22,70)
(23,21)-(23,59)
(23,21)-(23,38)
(23,22)-(23,26)
(23,27)-(23,37)
(23,28)-(23,30)
(23,32)-(23,33)
(23,35)-(23,36)
(23,42)-(23,59)
(23,43)-(23,47)
(23,48)-(23,58)
(23,49)-(23,51)
(23,53)-(23,54)
(23,56)-(23,57)
(25,6)-(27,30)
(25,9)-(25,44)
(25,9)-(25,25)
(25,10)-(25,14)
(25,15)-(25,24)
(25,16)-(25,17)
(25,19)-(25,20)
(25,22)-(25,23)
(25,28)-(25,44)
(25,29)-(25,33)
(25,34)-(25,43)
(25,35)-(25,36)
(25,38)-(25,39)
(25,41)-(25,42)
(26,11)-(26,30)
(26,11)-(26,15)
(26,16)-(26,30)
(26,17)-(26,23)
(26,25)-(26,26)
(26,28)-(26,29)
(27,11)-(27,30)
(27,11)-(27,15)
(27,16)-(27,30)
(27,17)-(27,23)
(27,25)-(27,26)
(27,28)-(27,29)
(28,18)-(28,43)
(28,18)-(28,35)
(28,19)-(28,23)
(28,24)-(28,34)
(28,25)-(28,27)
(28,29)-(28,30)
(28,32)-(28,33)
(28,39)-(28,43)
(29,17)-(29,44)
(29,17)-(29,34)
(29,18)-(29,22)
(29,23)-(29,33)
(29,24)-(29,26)
(29,28)-(29,29)
(29,31)-(29,32)
(29,38)-(29,44)
(29,40)-(29,43)
(31,6)-(33,49)
(31,6)-(32,49)
(31,7)-(31,46)
(31,8)-(31,25)
(31,9)-(31,13)
(31,14)-(31,24)
(31,15)-(31,17)
(31,19)-(31,20)
(31,22)-(31,23)
(31,28)-(31,45)
(31,29)-(31,33)
(31,34)-(31,44)
(31,35)-(31,37)
(31,39)-(31,40)
(31,42)-(31,43)
(32,9)-(32,48)
(32,10)-(32,27)
(32,11)-(32,15)
(32,16)-(32,26)
(32,17)-(32,19)
(32,21)-(32,22)
(32,24)-(32,25)
(32,30)-(32,47)
(32,31)-(32,35)
(32,36)-(32,46)
(32,37)-(32,39)
(32,41)-(32,42)
(32,44)-(32,45)
(33,10)-(33,49)
(33,11)-(33,28)
(33,12)-(33,16)
(33,17)-(33,27)
(33,18)-(33,20)
(33,22)-(33,23)
(33,25)-(33,26)
(33,31)-(33,48)
(33,32)-(33,36)
(33,37)-(33,47)
(33,38)-(33,40)
(33,42)-(33,43)
(33,45)-(33,46)
*)
