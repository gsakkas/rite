
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Halve of expr
  | Average of expr* expr
  | Times of expr* expr
  | Wow of expr* expr* expr
  | Thresh of expr* expr* expr* expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine x -> "sin(pi*" ^ ((exprToString x) ^ ")")
  | Cosine x -> "cos(pi*" ^ ((exprToString x) ^ ")")
  | Halve x -> "(" ^ (exprToString ^ ")/2")
  | Average (x,y) ->
      "((" ^ ((exprToString x) ^ ("*" ^ ((exprToString y) ^ ")/2)")))
  | Times (x,y) -> (exprToString x) ^ ("*" ^ (exprToString y))
  | Thresh (a,b,c,d) ->
      "(" ^
        ((exprToString a) ^
           ("<" ^
              ((exprToString b) ^
                 ("?" ^ ((exprToString c) ^ (":" ^ (exprToString d)))))))
  | Wow (x,y,z) ->
      "sqrt(" ^
        ("abs(" ^
           ((exprToString x) ^
              (")*" ^
                 ("abs(" ^
                    ((exprToString y) ^
                       (")*" ^ ("abs(" ^ ((exprToString z) ^ "))"))))))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Halve of expr
  | Average of expr* expr
  | Times of expr* expr
  | Wow of expr* expr* expr
  | Thresh of expr* expr* expr* expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine x -> "sin(pi*" ^ ((exprToString x) ^ ")")
  | Cosine x -> "cos(pi*" ^ ((exprToString x) ^ ")")
  | Halve x -> "(" ^ ((exprToString x) ^ ")/2")
  | Average (x,y) ->
      "((" ^ ((exprToString x) ^ ("*" ^ ((exprToString y) ^ ")/2)")))
  | Times (x,y) -> (exprToString x) ^ ("*" ^ (exprToString y))
  | Thresh (a,b,c,d) ->
      "(" ^
        ((exprToString a) ^
           ("<" ^
              ((exprToString b) ^
                 ("?" ^ ((exprToString c) ^ (":" ^ (exprToString d)))))))
  | Wow (x,y,z) ->
      "sqrt(" ^
        ("abs(" ^
           ((exprToString x) ^
              (")*" ^
                 ("abs(" ^
                    ((exprToString y) ^
                       (")*" ^ ("abs(" ^ ((exprToString z) ^ "))"))))))));;

*)

(* changed spans
(19,22)-(19,34)
(19,37)-(19,42)
*)

(* type error slice
(17,27)-(17,43)
(17,28)-(17,40)
(19,21)-(19,43)
(19,22)-(19,34)
(19,35)-(19,36)
*)

(* all spans
(13,21)-(36,73)
(14,2)-(36,73)
(14,8)-(14,9)
(15,13)-(15,16)
(16,13)-(16,16)
(17,14)-(17,50)
(17,24)-(17,25)
(17,14)-(17,23)
(17,26)-(17,50)
(17,44)-(17,45)
(17,27)-(17,43)
(17,28)-(17,40)
(17,41)-(17,42)
(17,46)-(17,49)
(18,16)-(18,52)
(18,26)-(18,27)
(18,16)-(18,25)
(18,28)-(18,52)
(18,46)-(18,47)
(18,29)-(18,45)
(18,30)-(18,42)
(18,43)-(18,44)
(18,48)-(18,51)
(19,15)-(19,43)
(19,19)-(19,20)
(19,15)-(19,18)
(19,21)-(19,43)
(19,35)-(19,36)
(19,22)-(19,34)
(19,37)-(19,42)
(21,6)-(21,69)
(21,11)-(21,12)
(21,6)-(21,10)
(21,13)-(21,69)
(21,31)-(21,32)
(21,14)-(21,30)
(21,15)-(21,27)
(21,28)-(21,29)
(21,33)-(21,68)
(21,38)-(21,39)
(21,34)-(21,37)
(21,40)-(21,67)
(21,58)-(21,59)
(21,41)-(21,57)
(21,42)-(21,54)
(21,55)-(21,56)
(21,60)-(21,66)
(22,19)-(22,62)
(22,36)-(22,37)
(22,19)-(22,35)
(22,20)-(22,32)
(22,33)-(22,34)
(22,38)-(22,62)
(22,43)-(22,44)
(22,39)-(22,42)
(22,45)-(22,61)
(22,46)-(22,58)
(22,59)-(22,60)
(24,6)-(28,73)
(24,10)-(24,11)
(24,6)-(24,9)
(25,8)-(28,73)
(25,26)-(25,27)
(25,9)-(25,25)
(25,10)-(25,22)
(25,23)-(25,24)
(26,11)-(28,72)
(26,16)-(26,17)
(26,12)-(26,15)
(27,14)-(28,71)
(27,32)-(27,33)
(27,15)-(27,31)
(27,16)-(27,28)
(27,29)-(27,30)
(28,17)-(28,70)
(28,22)-(28,23)
(28,18)-(28,21)
(28,24)-(28,69)
(28,42)-(28,43)
(28,25)-(28,41)
(28,26)-(28,38)
(28,39)-(28,40)
(28,44)-(28,68)
(28,49)-(28,50)
(28,45)-(28,48)
(28,51)-(28,67)
(28,52)-(28,64)
(28,65)-(28,66)
(30,6)-(36,73)
(30,14)-(30,15)
(30,6)-(30,13)
(31,8)-(36,73)
(31,16)-(31,17)
(31,9)-(31,15)
(32,11)-(36,72)
(32,29)-(32,30)
(32,12)-(32,28)
(32,13)-(32,25)
(32,26)-(32,27)
(33,14)-(36,71)
(33,20)-(33,21)
(33,15)-(33,19)
(34,17)-(36,70)
(34,25)-(34,26)
(34,18)-(34,24)
(35,20)-(36,69)
(35,38)-(35,39)
(35,21)-(35,37)
(35,22)-(35,34)
(35,35)-(35,36)
(36,23)-(36,68)
(36,29)-(36,30)
(36,24)-(36,28)
(36,31)-(36,67)
(36,39)-(36,40)
(36,32)-(36,38)
(36,41)-(36,66)
(36,59)-(36,60)
(36,42)-(36,58)
(36,43)-(36,55)
(36,56)-(36,57)
(36,61)-(36,65)
*)
