
let rec removeZero l =
  match l with | x::xs -> if x = 0 then removeZero xs else l | _ -> l;;

let rec mulByDigit i l =
  let lre = List.rev l in
  let rec helper carry accum lrev =
    match lrev with
    | [] -> removeZero accum
    | x::xs ->
        if carry = 1
        then
          (match accum with
           | x1'::xs' ->
               let num = (x * i) + x1' in
               if num < 10
               then (helper 0 num) :: (xs' xs)
               else (helper 1 ((num / 10) mod 10)) :: (num mod 10) ::
                 (xs' xs))
        else
          (let num = x * i in
           if num < 10
           then (helper 0 num) :: (accum xs)
           else (helper 1 ((num / 10) mod 10)) :: (num mod 10) :: (accum xs)) in
  helper 0 [] lre;;


(* fix

let rec removeZero l =
  match l with | x::xs -> if x = 0 then removeZero xs else l | _ -> l;;

let rec mulByDigit i l =
  let lre = List.rev l in
  let rec helper carry accum lrev =
    match lrev with
    | [] -> removeZero accum
    | x::xs ->
        if carry = 1
        then
          (match accum with
           | x1'::xs' ->
               let num = (x * i) + x1' in
               if num < 10
               then helper 0 (num :: xs') xs
               else helper 1 (((num / 10) mod 10) :: (num mod 10) :: xs') xs)
        else
          (let num = x * i in
           if num < 10
           then helper 0 (num :: accum) xs
           else helper 1 (((num / 10) mod 10) :: (num mod 10) :: accum) xs) in
  helper 0 [] lre;;

*)

(* changed spans
(17,20)-(17,34)
(17,20)-(17,46)
(17,30)-(17,33)
(17,38)-(17,46)
(18,20)-(18,50)
(18,20)-(19,25)
(18,30)-(18,49)
(19,17)-(19,25)
(23,16)-(23,30)
(23,16)-(23,44)
(23,26)-(23,29)
(23,34)-(23,44)
(24,16)-(24,46)
(24,16)-(24,76)
(24,26)-(24,45)
(24,66)-(24,76)
*)

(* type error slice
(3,2)-(3,69)
(3,40)-(3,50)
(3,40)-(3,53)
(3,51)-(3,53)
(7,2)-(25,17)
(7,17)-(24,77)
(7,23)-(24,77)
(7,29)-(24,77)
(9,12)-(9,22)
(9,12)-(9,28)
(9,23)-(9,28)
(13,10)-(19,26)
(17,38)-(17,46)
(17,39)-(17,42)
(18,20)-(18,50)
(18,20)-(19,25)
(18,21)-(18,27)
(18,54)-(18,66)
(18,54)-(19,25)
(19,17)-(19,25)
(19,18)-(19,21)
(23,34)-(23,44)
(23,35)-(23,40)
(24,66)-(24,76)
(24,67)-(24,72)
(25,2)-(25,8)
(25,2)-(25,17)
*)

(* all spans
(2,19)-(3,69)
(3,2)-(3,69)
(3,8)-(3,9)
(3,26)-(3,60)
(3,29)-(3,34)
(3,29)-(3,30)
(3,33)-(3,34)
(3,40)-(3,53)
(3,40)-(3,50)
(3,51)-(3,53)
(3,59)-(3,60)
(3,68)-(3,69)
(5,19)-(25,17)
(5,21)-(25,17)
(6,2)-(25,17)
(6,12)-(6,22)
(6,12)-(6,20)
(6,21)-(6,22)
(7,2)-(25,17)
(7,17)-(24,77)
(7,23)-(24,77)
(7,29)-(24,77)
(8,4)-(24,77)
(8,10)-(8,14)
(9,12)-(9,28)
(9,12)-(9,22)
(9,23)-(9,28)
(11,8)-(24,77)
(11,11)-(11,20)
(11,11)-(11,16)
(11,19)-(11,20)
(13,10)-(19,26)
(13,17)-(13,22)
(15,15)-(19,25)
(15,25)-(15,38)
(15,25)-(15,32)
(15,26)-(15,27)
(15,30)-(15,31)
(15,35)-(15,38)
(16,15)-(19,25)
(16,18)-(16,26)
(16,18)-(16,21)
(16,24)-(16,26)
(17,20)-(17,46)
(17,20)-(17,34)
(17,21)-(17,27)
(17,28)-(17,29)
(17,30)-(17,33)
(17,38)-(17,46)
(17,39)-(17,42)
(17,43)-(17,45)
(18,20)-(19,25)
(18,20)-(18,50)
(18,21)-(18,27)
(18,28)-(18,29)
(18,30)-(18,49)
(18,31)-(18,41)
(18,32)-(18,35)
(18,38)-(18,40)
(18,46)-(18,48)
(18,54)-(19,25)
(18,54)-(18,66)
(18,55)-(18,58)
(18,63)-(18,65)
(19,17)-(19,25)
(19,18)-(19,21)
(19,22)-(19,24)
(21,10)-(24,77)
(21,21)-(21,26)
(21,21)-(21,22)
(21,25)-(21,26)
(22,11)-(24,76)
(22,14)-(22,22)
(22,14)-(22,17)
(22,20)-(22,22)
(23,16)-(23,44)
(23,16)-(23,30)
(23,17)-(23,23)
(23,24)-(23,25)
(23,26)-(23,29)
(23,34)-(23,44)
(23,35)-(23,40)
(23,41)-(23,43)
(24,16)-(24,76)
(24,16)-(24,46)
(24,17)-(24,23)
(24,24)-(24,25)
(24,26)-(24,45)
(24,27)-(24,37)
(24,28)-(24,31)
(24,34)-(24,36)
(24,42)-(24,44)
(24,50)-(24,76)
(24,50)-(24,62)
(24,51)-(24,54)
(24,59)-(24,61)
(24,66)-(24,76)
(24,67)-(24,72)
(24,73)-(24,75)
(25,2)-(25,17)
(25,2)-(25,8)
(25,9)-(25,10)
(25,11)-(25,13)
(25,14)-(25,17)
*)
