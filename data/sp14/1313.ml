
let bigMul l1 l2 =
  let f a x =
    let (l1',l2') = x in
    let (pos,total) = a in
    match l2' with | [] -> [] | h::t -> ((pos + 1), total) in
  let base = (0, [0]) in
  let args = ((List.rev l1), (List.rev l2)) in
  let (_,res) = List.fold_left f base args in res;;


(* fix

let bigMul l1 l2 =
  let f a x = let (pos,total) = a in (pos, l2) in
  let base = (0, [0]) in
  let args = List.rev l1 in let (_,res) = List.fold_left f base args in res;;

*)

(* changed spans
(4,4)-(6,58)
(4,20)-(4,21)
(6,4)-(6,58)
(6,10)-(6,13)
(6,27)-(6,29)
(6,41)-(6,50)
(6,48)-(6,49)
(6,52)-(6,57)
(8,13)-(8,43)
(8,29)-(8,42)
(8,30)-(8,38)
(8,39)-(8,41)
*)

(* type error slice
(3,2)-(9,49)
(3,8)-(6,58)
(3,10)-(6,58)
(4,4)-(6,58)
(5,4)-(6,58)
(5,22)-(5,23)
(6,4)-(6,58)
(6,27)-(6,29)
(6,40)-(6,58)
(9,16)-(9,30)
(9,16)-(9,42)
(9,31)-(9,32)
*)

(* all spans
(2,11)-(9,49)
(2,14)-(9,49)
(3,2)-(9,49)
(3,8)-(6,58)
(3,10)-(6,58)
(4,4)-(6,58)
(4,20)-(4,21)
(5,4)-(6,58)
(5,22)-(5,23)
(6,4)-(6,58)
(6,10)-(6,13)
(6,27)-(6,29)
(6,40)-(6,58)
(6,41)-(6,50)
(6,42)-(6,45)
(6,48)-(6,49)
(6,52)-(6,57)
(7,2)-(9,49)
(7,13)-(7,21)
(7,14)-(7,15)
(7,17)-(7,20)
(7,18)-(7,19)
(8,2)-(9,49)
(8,13)-(8,43)
(8,14)-(8,27)
(8,15)-(8,23)
(8,24)-(8,26)
(8,29)-(8,42)
(8,30)-(8,38)
(8,39)-(8,41)
(9,2)-(9,49)
(9,16)-(9,42)
(9,16)-(9,30)
(9,31)-(9,32)
(9,33)-(9,37)
(9,38)-(9,42)
(9,46)-(9,49)
*)
