
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Half of expr
  | ThreeAve of expr* expr* expr;;

let buildX () = VarX;;

let buildY () = VarY;;

let rec build (rand,depth) =
  match rand with
  | (a,b) ->
      let rdm = rand (0, 7) in
      (match rdm with
       | 0 -> buildY ()
       | 1 -> buildX ()
       | 2 -> Cosine (build (rand, (depth - 1)))
       | 3 -> Sine (build (rand, (depth - 1)))
       | 4 ->
           Average ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
       | 5 ->
           Times ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
       | 6 ->
           Thresh
             ((build (rand, (depth - 1))), (build (rand, (depth - 1))),
               (build (rand, (depth - 1))), (build (rand, (depth - 1)))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Half of expr
  | ThreeAve of expr* expr* expr;;

let buildX () = VarX;;

let buildY () = VarY;;

let rec build (rand,depth) =
  let rdm = rand (0, 7) in
  match rdm with
  | 0 -> buildY ()
  | 1 -> buildX ()
  | 2 -> Cosine (build (rand, (depth - 1)))
  | 3 -> Sine (build (rand, (depth - 1)))
  | 4 -> Average ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
  | 5 -> Times ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
  | 6 ->
      Thresh
        ((build (rand, (depth - 1))), (build (rand, (depth - 1))),
          (build (rand, (depth - 1))), (build (rand, (depth - 1))));;

*)

(* changed spans
(18,2)-(33,73)
(18,8)-(18,12)
*)

(* type error slice
(18,2)-(33,73)
(18,8)-(18,12)
(20,16)-(20,20)
(20,16)-(20,27)
*)

(* all spans
(13,11)-(13,20)
(13,16)-(13,20)
(15,11)-(15,20)
(15,16)-(15,20)
(17,15)-(33,73)
(18,2)-(33,73)
(18,8)-(18,12)
(20,6)-(33,73)
(20,16)-(20,27)
(20,16)-(20,20)
(20,21)-(20,27)
(20,22)-(20,23)
(20,25)-(20,26)
(21,6)-(33,73)
(21,13)-(21,16)
(22,14)-(22,23)
(22,14)-(22,20)
(22,21)-(22,23)
(23,14)-(23,23)
(23,14)-(23,20)
(23,21)-(23,23)
(24,14)-(24,48)
(24,21)-(24,48)
(24,22)-(24,27)
(24,28)-(24,47)
(24,29)-(24,33)
(24,35)-(24,46)
(24,36)-(24,41)
(24,44)-(24,45)
(25,14)-(25,46)
(25,19)-(25,46)
(25,20)-(25,25)
(25,26)-(25,45)
(25,27)-(25,31)
(25,33)-(25,44)
(25,34)-(25,39)
(25,42)-(25,43)
(27,11)-(27,77)
(27,20)-(27,47)
(27,21)-(27,26)
(27,27)-(27,46)
(27,28)-(27,32)
(27,34)-(27,45)
(27,35)-(27,40)
(27,43)-(27,44)
(27,49)-(27,76)
(27,50)-(27,55)
(27,56)-(27,75)
(27,57)-(27,61)
(27,63)-(27,74)
(27,64)-(27,69)
(27,72)-(27,73)
(29,11)-(29,75)
(29,18)-(29,45)
(29,19)-(29,24)
(29,25)-(29,44)
(29,26)-(29,30)
(29,32)-(29,43)
(29,33)-(29,38)
(29,41)-(29,42)
(29,47)-(29,74)
(29,48)-(29,53)
(29,54)-(29,73)
(29,55)-(29,59)
(29,61)-(29,72)
(29,62)-(29,67)
(29,70)-(29,71)
(31,11)-(33,72)
(32,14)-(32,41)
(32,15)-(32,20)
(32,21)-(32,40)
(32,22)-(32,26)
(32,28)-(32,39)
(32,29)-(32,34)
(32,37)-(32,38)
(32,43)-(32,70)
(32,44)-(32,49)
(32,50)-(32,69)
(32,51)-(32,55)
(32,57)-(32,68)
(32,58)-(32,63)
(32,66)-(32,67)
(33,15)-(33,42)
(33,16)-(33,21)
(33,22)-(33,41)
(33,23)-(33,27)
(33,29)-(33,40)
(33,30)-(33,35)
(33,38)-(33,39)
(33,44)-(33,71)
(33,45)-(33,50)
(33,51)-(33,70)
(33,52)-(33,56)
(33,58)-(33,69)
(33,59)-(33,64)
(33,67)-(33,68)
*)
