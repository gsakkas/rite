
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Op1 of expr
  | Op2 of expr* expr* expr;;

let buildCosine e = Cosine e;;

let buildOp2 (a,b,a_less,b_less) = Op2 (a, b, a_less);;

let buildSine e = Sine e;;

let buildX () = VarX;;

let rec build (rand,depth) =
  if depth = 0
  then buildSine (buildX ())
  else
    (let randNum = rand (1, 2) in
     let randNum2 = rand (1, 2) in
     let randNum3 = rand (1, 2) in
     match (randNum, randNum2) with
     | (1,1) -> buildSine (build (rand, (depth - 1)))
     | (2,2) -> buildCosine (build (rand, (depth - 1)))
     | _ ->
         (match randNum3 with
          | 1 ->
              buildSine
                (buildOp2
                   ((build (rand, (depth - 1))), (build (rand, (depth - 1))),
                     (build (rand, (depth - 1)))))
          | 2 ->
              buildCosine
                (buildOp2
                   ((build (rand, (depth - 1))), (build (rand, (depth - 1))),
                     (build (rand, (depth - 1)))))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Op1 of expr
  | Op2 of expr* expr* expr;;

let buildCosine e = Cosine e;;

let buildOp1 e = Op1 e;;

let buildSine e = Sine e;;

let buildX () = VarX;;

let rec build (rand,depth) =
  if depth = 0
  then buildSine (buildX ())
  else
    (let randNum = rand (1, 2) in
     let randNum2 = rand (1, 2) in
     let randNum3 = rand (1, 2) in
     match (randNum, randNum2) with
     | (1,1) -> buildSine (build (rand, (depth - 1)))
     | (2,2) -> buildCosine (build (rand, (depth - 1)))
     | _ ->
         (match randNum3 with
          | 1 -> buildSine (buildOp1 (build (rand, (depth - 1))))
          | 2 -> buildCosine (buildOp1 (build (rand, (depth - 1))))));;

*)

(* changed spans
(15,14)-(15,53)
(15,35)-(15,53)
(15,40)-(15,41)
(15,43)-(15,44)
(15,46)-(15,52)
(17,18)-(17,24)
(35,17)-(35,25)
(36,19)-(37,49)
(36,20)-(36,47)
(36,21)-(36,26)
(36,27)-(36,46)
(36,28)-(36,32)
(36,34)-(36,45)
(36,35)-(36,40)
(36,43)-(36,44)
(36,49)-(36,76)
(36,50)-(36,55)
(36,56)-(36,75)
(36,57)-(36,61)
(36,63)-(36,74)
(36,64)-(36,69)
(36,72)-(36,73)
(40,17)-(40,25)
(41,19)-(42,49)
(41,20)-(41,47)
(41,21)-(41,26)
(41,27)-(41,46)
(41,28)-(41,32)
(41,34)-(41,45)
(41,35)-(41,40)
(41,43)-(41,44)
(41,49)-(41,76)
(41,50)-(41,55)
(41,56)-(41,75)
(41,57)-(41,61)
(41,63)-(41,74)
(41,64)-(41,69)
(41,72)-(41,73)
*)

(* type error slice
(15,3)-(15,55)
(15,14)-(15,53)
(35,16)-(37,50)
(35,17)-(35,25)
(36,19)-(37,49)
(40,16)-(42,50)
(40,17)-(40,25)
(41,19)-(42,49)
*)

(* all spans
(13,16)-(13,28)
(13,20)-(13,28)
(13,27)-(13,28)
(15,14)-(15,53)
(15,35)-(15,53)
(15,40)-(15,41)
(15,43)-(15,44)
(15,46)-(15,52)
(17,14)-(17,24)
(17,18)-(17,24)
(17,23)-(17,24)
(19,11)-(19,20)
(19,16)-(19,20)
(21,15)-(42,52)
(22,2)-(42,52)
(22,5)-(22,14)
(22,5)-(22,10)
(22,13)-(22,14)
(23,7)-(23,28)
(23,7)-(23,16)
(23,17)-(23,28)
(23,18)-(23,24)
(23,25)-(23,27)
(25,4)-(42,52)
(25,19)-(25,30)
(25,19)-(25,23)
(25,24)-(25,30)
(25,25)-(25,26)
(25,28)-(25,29)
(26,5)-(42,51)
(26,20)-(26,31)
(26,20)-(26,24)
(26,25)-(26,31)
(26,26)-(26,27)
(26,29)-(26,30)
(27,5)-(42,51)
(27,20)-(27,31)
(27,20)-(27,24)
(27,25)-(27,31)
(27,26)-(27,27)
(27,29)-(27,30)
(28,5)-(42,51)
(28,11)-(28,30)
(28,12)-(28,19)
(28,21)-(28,29)
(29,16)-(29,53)
(29,16)-(29,25)
(29,26)-(29,53)
(29,27)-(29,32)
(29,33)-(29,52)
(29,34)-(29,38)
(29,40)-(29,51)
(29,41)-(29,46)
(29,49)-(29,50)
(30,16)-(30,55)
(30,16)-(30,27)
(30,28)-(30,55)
(30,29)-(30,34)
(30,35)-(30,54)
(30,36)-(30,40)
(30,42)-(30,53)
(30,43)-(30,48)
(30,51)-(30,52)
(32,9)-(42,51)
(32,16)-(32,24)
(34,14)-(37,50)
(34,14)-(34,23)
(35,16)-(37,50)
(35,17)-(35,25)
(36,19)-(37,49)
(36,20)-(36,47)
(36,21)-(36,26)
(36,27)-(36,46)
(36,28)-(36,32)
(36,34)-(36,45)
(36,35)-(36,40)
(36,43)-(36,44)
(36,49)-(36,76)
(36,50)-(36,55)
(36,56)-(36,75)
(36,57)-(36,61)
(36,63)-(36,74)
(36,64)-(36,69)
(36,72)-(36,73)
(37,21)-(37,48)
(37,22)-(37,27)
(37,28)-(37,47)
(37,29)-(37,33)
(37,35)-(37,46)
(37,36)-(37,41)
(37,44)-(37,45)
(39,14)-(42,50)
(39,14)-(39,25)
(40,16)-(42,50)
(40,17)-(40,25)
(41,19)-(42,49)
(41,20)-(41,47)
(41,21)-(41,26)
(41,27)-(41,46)
(41,28)-(41,32)
(41,34)-(41,45)
(41,35)-(41,40)
(41,43)-(41,44)
(41,49)-(41,76)
(41,50)-(41,55)
(41,56)-(41,75)
(41,57)-(41,61)
(41,63)-(41,74)
(41,64)-(41,69)
(41,72)-(41,73)
(42,21)-(42,48)
(42,22)-(42,27)
(42,28)-(42,47)
(42,29)-(42,33)
(42,35)-(42,46)
(42,36)-(42,41)
(42,44)-(42,45)
*)
