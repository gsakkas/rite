
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr;;

let rec exprToString e =
  match e with
  | Thresh (a,b,c,d) ->
      "(" ^
        ((exprToString a) ^
           ("<" ^
              ((exprToString b) ^
                 ("?" ^ ((exprToString c) ^ (":" ^ ((exprToString d) ^ ")")))))))
  | Times (a,b) -> (exprToString a) ^ ("*" ^ (exprToString b))
  | Average (a,b) ->
      "((" ^ ((exprToString a) ^ (("+" exprToString b) ^ ")/20"))
  | Cosine a -> "cos(pi*" ^ ((exprToString a) ^ ")")
  | Sine a -> "sin(pi*" ^ ((exprToString a) ^ ")")
  | VarY  -> "x"
  | VarX  -> "y";;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr;;

let rec exprToString e =
  match e with
  | Thresh (a,b,c,d) ->
      "(" ^
        ((exprToString a) ^
           ("<" ^
              ((exprToString b) ^
                 ("?" ^ ((exprToString c) ^ (":" ^ ((exprToString d) ^ ")")))))))
  | Times (a,b) -> (exprToString a) ^ ("*" ^ (exprToString b))
  | Average (a,b) ->
      "((" ^ ((exprToString a) ^ ("+" ^ ((exprToString b) ^ ")/20")))
  | Cosine a -> "cos(pi*" ^ ((exprToString a) ^ ")")
  | Sine a -> "sin(pi*" ^ ((exprToString a) ^ ")")
  | VarY  -> "x"
  | VarX  -> "y";;

*)

(* changed spans
(21,34)-(21,54)
(21,39)-(21,51)
*)

(* type error slice
(21,34)-(21,54)
(21,35)-(21,38)
*)

(* all spans
(11,21)-(25,16)
(12,2)-(25,16)
(12,8)-(12,9)
(14,6)-(18,81)
(14,10)-(14,11)
(14,6)-(14,9)
(15,8)-(18,81)
(15,26)-(15,27)
(15,9)-(15,25)
(15,10)-(15,22)
(15,23)-(15,24)
(16,11)-(18,80)
(16,16)-(16,17)
(16,12)-(16,15)
(17,14)-(18,79)
(17,32)-(17,33)
(17,15)-(17,31)
(17,16)-(17,28)
(17,29)-(17,30)
(18,17)-(18,78)
(18,22)-(18,23)
(18,18)-(18,21)
(18,24)-(18,77)
(18,42)-(18,43)
(18,25)-(18,41)
(18,26)-(18,38)
(18,39)-(18,40)
(18,44)-(18,76)
(18,49)-(18,50)
(18,45)-(18,48)
(18,51)-(18,75)
(18,69)-(18,70)
(18,52)-(18,68)
(18,53)-(18,65)
(18,66)-(18,67)
(18,71)-(18,74)
(19,19)-(19,62)
(19,36)-(19,37)
(19,19)-(19,35)
(19,20)-(19,32)
(19,33)-(19,34)
(19,38)-(19,62)
(19,43)-(19,44)
(19,39)-(19,42)
(19,45)-(19,61)
(19,46)-(19,58)
(19,59)-(19,60)
(21,6)-(21,65)
(21,11)-(21,12)
(21,6)-(21,10)
(21,13)-(21,65)
(21,31)-(21,32)
(21,14)-(21,30)
(21,15)-(21,27)
(21,28)-(21,29)
(21,33)-(21,64)
(21,55)-(21,56)
(21,34)-(21,54)
(21,35)-(21,38)
(21,39)-(21,51)
(21,52)-(21,53)
(21,57)-(21,63)
(22,16)-(22,52)
(22,26)-(22,27)
(22,16)-(22,25)
(22,28)-(22,52)
(22,46)-(22,47)
(22,29)-(22,45)
(22,30)-(22,42)
(22,43)-(22,44)
(22,48)-(22,51)
(23,14)-(23,50)
(23,24)-(23,25)
(23,14)-(23,23)
(23,26)-(23,50)
(23,44)-(23,45)
(23,27)-(23,43)
(23,28)-(23,40)
(23,41)-(23,42)
(23,46)-(23,49)
(24,13)-(24,16)
(25,13)-(25,16)
*)
