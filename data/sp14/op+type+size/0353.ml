
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Tan of expr
  | Average of expr* expr
  | Times of expr* expr
  | TimesMod of expr* expr* expr
  | Thresh of expr* expr* expr* expr;;

let pi = 4.0 *. (atan 1.0);;

let rec eval (e,x,y) =
  match e with
  | Thresh (w,t,u,z) ->
      if (eval (w, x, y)) < (eval (t, x, y))
      then eval (u, x, y)
      else eval (z, x, y)
  | TimesMod (w,t,u) ->
      ((eval (w, x, y)) *. (eval (t, x, y))) /.
        (mod_float ((eval (w, x, y)) *. (eval (t, x, y))) (eval (u, x, y)))
  | Times (t,u) -> (eval (t, x, y)) *. (eval (u, x, y))
  | Average (t,u) -> ((eval (t, x, y)) +. (eval (u, x, y))) /. 2.0
  | Cosine t -> cos (pi *. (eval (t, x, y)))
  | Sine t -> sin (pi *. (eval (t, x, y)))
  | Tan t -> mod_float (tan (pi *. (eval (t, x, y)))) 1
  | VarX  -> x
  | VarY  -> y;;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Tan of expr
  | Average of expr* expr
  | Times of expr* expr
  | TimesMod of expr* expr* expr
  | Thresh of expr* expr* expr* expr;;

let pi = 4.0 *. (atan 1.0);;

let rec eval (e,x,y) =
  match e with
  | Thresh (w,t,u,z) ->
      if (eval (w, x, y)) < (eval (t, x, y))
      then eval (u, x, y)
      else eval (z, x, y)
  | TimesMod (w,t,u) ->
      ((eval (w, x, y)) *. (eval (t, x, y))) /.
        (mod_float ((eval (w, x, y)) *. (eval (t, x, y))) (eval (u, x, y)))
  | Times (t,u) -> (eval (t, x, y)) *. (eval (u, x, y))
  | Average (t,u) -> ((eval (t, x, y)) +. (eval (u, x, y))) /. 2.0
  | Cosine t -> cos (pi *. (eval (t, x, y)))
  | Sine t -> sin (pi *. (eval (t, x, y)))
  | Tan t -> mod_float (tan (pi *. (eval (t, x, y)))) 1.0
  | VarX  -> x
  | VarY  -> y;;

*)

(* changed spans
(28,54)-(28,55)
*)

(* type error slice
(28,13)-(28,22)
(28,13)-(28,55)
(28,54)-(28,55)
*)

(* all spans
(13,9)-(13,26)
(13,9)-(13,12)
(13,16)-(13,26)
(13,17)-(13,21)
(13,22)-(13,25)
(15,14)-(30,14)
(16,2)-(30,14)
(16,8)-(16,9)
(18,6)-(20,25)
(18,9)-(18,44)
(18,9)-(18,25)
(18,10)-(18,14)
(18,15)-(18,24)
(18,16)-(18,17)
(18,19)-(18,20)
(18,22)-(18,23)
(18,28)-(18,44)
(18,29)-(18,33)
(18,34)-(18,43)
(18,35)-(18,36)
(18,38)-(18,39)
(18,41)-(18,42)
(19,11)-(19,25)
(19,11)-(19,15)
(19,16)-(19,25)
(19,17)-(19,18)
(19,20)-(19,21)
(19,23)-(19,24)
(20,11)-(20,25)
(20,11)-(20,15)
(20,16)-(20,25)
(20,17)-(20,18)
(20,20)-(20,21)
(20,23)-(20,24)
(22,6)-(23,75)
(22,6)-(22,44)
(22,7)-(22,23)
(22,8)-(22,12)
(22,13)-(22,22)
(22,14)-(22,15)
(22,17)-(22,18)
(22,20)-(22,21)
(22,27)-(22,43)
(22,28)-(22,32)
(22,33)-(22,42)
(22,34)-(22,35)
(22,37)-(22,38)
(22,40)-(22,41)
(23,8)-(23,75)
(23,9)-(23,18)
(23,19)-(23,57)
(23,20)-(23,36)
(23,21)-(23,25)
(23,26)-(23,35)
(23,27)-(23,28)
(23,30)-(23,31)
(23,33)-(23,34)
(23,40)-(23,56)
(23,41)-(23,45)
(23,46)-(23,55)
(23,47)-(23,48)
(23,50)-(23,51)
(23,53)-(23,54)
(23,58)-(23,74)
(23,59)-(23,63)
(23,64)-(23,73)
(23,65)-(23,66)
(23,68)-(23,69)
(23,71)-(23,72)
(24,19)-(24,55)
(24,19)-(24,35)
(24,20)-(24,24)
(24,25)-(24,34)
(24,26)-(24,27)
(24,29)-(24,30)
(24,32)-(24,33)
(24,39)-(24,55)
(24,40)-(24,44)
(24,45)-(24,54)
(24,46)-(24,47)
(24,49)-(24,50)
(24,52)-(24,53)
(25,21)-(25,66)
(25,21)-(25,59)
(25,22)-(25,38)
(25,23)-(25,27)
(25,28)-(25,37)
(25,29)-(25,30)
(25,32)-(25,33)
(25,35)-(25,36)
(25,42)-(25,58)
(25,43)-(25,47)
(25,48)-(25,57)
(25,49)-(25,50)
(25,52)-(25,53)
(25,55)-(25,56)
(25,63)-(25,66)
(26,16)-(26,44)
(26,16)-(26,19)
(26,20)-(26,44)
(26,21)-(26,23)
(26,27)-(26,43)
(26,28)-(26,32)
(26,33)-(26,42)
(26,34)-(26,35)
(26,37)-(26,38)
(26,40)-(26,41)
(27,14)-(27,42)
(27,14)-(27,17)
(27,18)-(27,42)
(27,19)-(27,21)
(27,25)-(27,41)
(27,26)-(27,30)
(27,31)-(27,40)
(27,32)-(27,33)
(27,35)-(27,36)
(27,38)-(27,39)
(28,13)-(28,55)
(28,13)-(28,22)
(28,23)-(28,53)
(28,24)-(28,27)
(28,28)-(28,52)
(28,29)-(28,31)
(28,35)-(28,51)
(28,36)-(28,40)
(28,41)-(28,50)
(28,42)-(28,43)
(28,45)-(28,46)
(28,48)-(28,49)
(28,54)-(28,55)
(29,13)-(29,14)
(30,13)-(30,14)
*)
