
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Op1 of expr
  | Op2 of expr* expr* expr;;

let buildOp1 e = Op1 e;;

let buildOp2 (a,b,a_less,b_less) = Op2 (a, b, a_less);;

let buildSine e = Sine e;;

let buildX () = VarX;;

let rec build (rand,depth) =
  if depth = (-1)
  then
    let randNum = rand (1, 2) in
    let randNum2 = rand (3, 4) in
    (if (randNum = 1) && (randNum2 = 3)
     then buildSine (buildOp1 (buildX ()))
     else
       if (randNum = 1) && (randNum2 = 4)
       then
         buildSine
           (buildOp2
              ((build (rand, (depth - 1))), (build (rand, (depth - 1))),
                (build (rand, (depth - 1))))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Op1 of expr
  | Op2 of expr* expr* expr;;

let buildSine e = Sine e;;

let buildX () = VarX;;

let rec build (rand,depth) =
  if depth = 0 then buildSine (buildX ()) else buildX ();;

*)

(* changed spans
(13,17)-(13,22)
(13,21)-(13,22)
(15,14)-(15,53)
(15,35)-(15,53)
(15,40)-(15,41)
(15,43)-(15,44)
(15,46)-(15,52)
(17,14)-(17,24)
(22,13)-(22,17)
(24,4)-(34,46)
(24,18)-(24,22)
(24,18)-(24,29)
*)

(* type error slice
(15,3)-(15,55)
(15,14)-(15,53)
(17,3)-(17,26)
(17,14)-(17,24)
(17,18)-(17,24)
(22,2)-(34,46)
(22,2)-(34,46)
(22,2)-(34,46)
(24,4)-(34,46)
(25,4)-(34,46)
(26,4)-(34,46)
(27,10)-(27,19)
(27,10)-(27,42)
(29,7)-(34,45)
(29,7)-(34,45)
(29,7)-(34,45)
(31,9)-(31,18)
(31,9)-(34,45)
(32,11)-(34,45)
(32,12)-(32,20)
(33,14)-(34,44)
*)

(* all spans
(13,13)-(13,22)
(13,17)-(13,22)
(13,21)-(13,22)
(15,14)-(15,53)
(15,35)-(15,53)
(15,40)-(15,41)
(15,43)-(15,44)
(15,46)-(15,52)
(17,14)-(17,24)
(17,18)-(17,24)
(17,23)-(17,24)
(19,11)-(19,20)
(19,16)-(19,20)
(21,15)-(34,46)
(22,2)-(34,46)
(22,5)-(22,17)
(22,5)-(22,10)
(22,13)-(22,17)
(24,4)-(34,46)
(24,18)-(24,29)
(24,18)-(24,22)
(24,23)-(24,29)
(24,24)-(24,25)
(24,27)-(24,28)
(25,4)-(34,46)
(25,19)-(25,30)
(25,19)-(25,23)
(25,24)-(25,30)
(25,25)-(25,26)
(25,28)-(25,29)
(26,4)-(34,46)
(26,8)-(26,39)
(26,8)-(26,21)
(26,9)-(26,16)
(26,19)-(26,20)
(26,25)-(26,39)
(26,26)-(26,34)
(26,37)-(26,38)
(27,10)-(27,42)
(27,10)-(27,19)
(27,20)-(27,42)
(27,21)-(27,29)
(27,30)-(27,41)
(27,31)-(27,37)
(27,38)-(27,40)
(29,7)-(34,45)
(29,10)-(29,41)
(29,10)-(29,23)
(29,11)-(29,18)
(29,21)-(29,22)
(29,27)-(29,41)
(29,28)-(29,36)
(29,39)-(29,40)
(31,9)-(34,45)
(31,9)-(31,18)
(32,11)-(34,45)
(32,12)-(32,20)
(33,14)-(34,44)
(33,15)-(33,42)
(33,16)-(33,21)
(33,22)-(33,41)
(33,23)-(33,27)
(33,29)-(33,40)
(33,30)-(33,35)
(33,38)-(33,39)
(33,44)-(33,71)
(33,45)-(33,50)
(33,51)-(33,70)
(33,52)-(33,56)
(33,58)-(33,69)
(33,59)-(33,64)
(33,67)-(33,68)
(34,16)-(34,43)
(34,17)-(34,22)
(34,23)-(34,42)
(34,24)-(34,28)
(34,30)-(34,41)
(34,31)-(34,36)
(34,39)-(34,40)
(29,7)-(34,45)
(22,2)-(34,46)
*)
