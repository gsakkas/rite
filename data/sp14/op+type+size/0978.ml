
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr;;

let buildCosine e = Cosine e;;

let buildSine e = Sine e;;

let buildTimes (e1,e2) = Times (e1, e2);;

let buildX () = VarX;;

let buildY () = VarY;;

let rec build (rand,depth) =
  match (rand, depth) with
  | (_,0) -> if (rand mod 2) == 0 then buildY () else buildX ()
  | (_,1) ->
      if (rand mod 3) == 0
      then buildSine (build (rand, (depth - 1)))
      else buildCosine (build (rand, (depth - 1)))
  | (_,2) ->
      buildTimes
        (((build rand), (depth - 1)), (build ((rand + 1), (depth - 1))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr;;

let buildCosine e = Cosine e;;

let buildSine e = Sine e;;

let buildX () = VarX;;

let rec build (rand,depth) =
  match depth with
  | 0 -> buildX ()
  | 1 -> buildSine (build (rand, (depth - 1)))
  | _ -> buildCosine (build (rand, (depth - 1)));;

*)

(* changed spans
(15,16)-(15,39)
(15,25)-(15,39)
(15,32)-(15,34)
(15,36)-(15,38)
(19,11)-(19,20)
(19,16)-(19,20)
(22,2)-(30,72)
(22,8)-(22,21)
(22,9)-(22,13)
(23,13)-(23,63)
(23,16)-(23,28)
(23,16)-(23,33)
(23,17)-(23,21)
(23,26)-(23,27)
(23,32)-(23,33)
(23,39)-(23,45)
(23,46)-(23,48)
(23,54)-(23,63)
(25,6)-(27,50)
(25,9)-(25,26)
(25,10)-(25,14)
(25,19)-(25,20)
(25,25)-(25,26)
*)

(* type error slice
(15,3)-(15,41)
(15,16)-(15,39)
(15,25)-(15,39)
(15,32)-(15,34)
(26,21)-(26,48)
(26,22)-(26,27)
(26,28)-(26,47)
(26,29)-(26,33)
(29,6)-(29,16)
(29,6)-(30,72)
(30,8)-(30,72)
(30,9)-(30,36)
(30,10)-(30,22)
(30,11)-(30,16)
(30,17)-(30,21)
*)

(* all spans
(11,16)-(11,28)
(11,20)-(11,28)
(11,27)-(11,28)
(13,14)-(13,24)
(13,18)-(13,24)
(13,23)-(13,24)
(15,16)-(15,39)
(15,25)-(15,39)
(15,32)-(15,34)
(15,36)-(15,38)
(17,11)-(17,20)
(17,16)-(17,20)
(19,11)-(19,20)
(19,16)-(19,20)
(21,15)-(30,72)
(22,2)-(30,72)
(22,8)-(22,21)
(22,9)-(22,13)
(22,15)-(22,20)
(23,13)-(23,63)
(23,16)-(23,33)
(23,16)-(23,28)
(23,17)-(23,21)
(23,26)-(23,27)
(23,32)-(23,33)
(23,39)-(23,48)
(23,39)-(23,45)
(23,46)-(23,48)
(23,54)-(23,63)
(23,54)-(23,60)
(23,61)-(23,63)
(25,6)-(27,50)
(25,9)-(25,26)
(25,9)-(25,21)
(25,10)-(25,14)
(25,19)-(25,20)
(25,25)-(25,26)
(26,11)-(26,48)
(26,11)-(26,20)
(26,21)-(26,48)
(26,22)-(26,27)
(26,28)-(26,47)
(26,29)-(26,33)
(26,35)-(26,46)
(26,36)-(26,41)
(26,44)-(26,45)
(27,11)-(27,50)
(27,11)-(27,22)
(27,23)-(27,50)
(27,24)-(27,29)
(27,30)-(27,49)
(27,31)-(27,35)
(27,37)-(27,48)
(27,38)-(27,43)
(27,46)-(27,47)
(29,6)-(30,72)
(29,6)-(29,16)
(30,8)-(30,72)
(30,9)-(30,36)
(30,10)-(30,22)
(30,11)-(30,16)
(30,17)-(30,21)
(30,24)-(30,35)
(30,25)-(30,30)
(30,33)-(30,34)
(30,38)-(30,71)
(30,39)-(30,44)
(30,45)-(30,70)
(30,46)-(30,56)
(30,47)-(30,51)
(30,54)-(30,55)
(30,58)-(30,69)
(30,59)-(30,64)
(30,67)-(30,68)
*)
