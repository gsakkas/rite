
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Inverse of expr
  | Max of expr* expr
  | Range of expr* expr* expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine a -> "sin(pi*" ^ ((exprToString a) ^ ")")
  | Cosine a -> "cos(pi*" ^ ((exprToString a) ^ ")")
  | Average (a,b) ->
      "((" ^ ((exprToString a) ^ ("+" ^ ((exprToString b) ^ ")/2)")))
  | Times (a,b) -> (exprToString a) ^ ("*" ^ (exprToString b))
  | Thresh (a,b,c,d) ->
      "(" ^
        ((exprToString a) ^
           ("<" ^
              ((exprToString b) ^
                 ("?" ^ ((exprToString c) ^ (":" ^ ((exprToString d) ^ ")")))))))
  | Inverse a -> "1/" ^ (exprToString a)
  | Max (a,b) ->
      "max(" ^ ((exprToString a) ^ ("," ^ ((exprToString b) ^ ")")))
  | Range (a,b,c) ->
      "range(" ^
        ((exprToString a) ^
           (("," exprToString b) ^ ("," ^ ((exprToString c) ^ ")"))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Inverse of expr
  | Max of expr* expr
  | Range of expr* expr* expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine a -> "sin(pi*" ^ ((exprToString a) ^ ")")
  | Cosine a -> "cos(pi*" ^ ((exprToString a) ^ ")")
  | Average (a,b) ->
      "((" ^ ((exprToString a) ^ ("+" ^ ((exprToString b) ^ ")/2)")))
  | Times (a,b) -> (exprToString a) ^ ("*" ^ (exprToString b))
  | Thresh (a,b,c,d) ->
      "(" ^
        ((exprToString a) ^
           ("<" ^
              ((exprToString b) ^
                 ("?" ^ ((exprToString c) ^ (":" ^ ((exprToString d) ^ ")")))))))
  | Inverse a -> "1/" ^ (exprToString a)
  | Max (a,b) ->
      "max(" ^ ((exprToString a) ^ ("," ^ ((exprToString b) ^ ")")))
  | Range (a,b,c) ->
      "range(" ^
        ((exprToString a) ^
           ("," ^ ((exprToString b) ^ ("," ^ ((exprToString c) ^ ")")))));;

*)

(* changed spans
(35,12)-(35,32)
(35,17)-(35,29)
*)

(* type error slice
(35,12)-(35,32)
(35,13)-(35,16)
*)

(* all spans
(14,21)-(35,69)
(15,2)-(35,69)
(15,8)-(15,9)
(16,13)-(16,16)
(17,13)-(17,16)
(18,14)-(18,50)
(18,24)-(18,25)
(18,14)-(18,23)
(18,26)-(18,50)
(18,44)-(18,45)
(18,27)-(18,43)
(18,28)-(18,40)
(18,41)-(18,42)
(18,46)-(18,49)
(19,16)-(19,52)
(19,26)-(19,27)
(19,16)-(19,25)
(19,28)-(19,52)
(19,46)-(19,47)
(19,29)-(19,45)
(19,30)-(19,42)
(19,43)-(19,44)
(19,48)-(19,51)
(21,6)-(21,69)
(21,11)-(21,12)
(21,6)-(21,10)
(21,13)-(21,69)
(21,31)-(21,32)
(21,14)-(21,30)
(21,15)-(21,27)
(21,28)-(21,29)
(21,33)-(21,68)
(21,38)-(21,39)
(21,34)-(21,37)
(21,40)-(21,67)
(21,58)-(21,59)
(21,41)-(21,57)
(21,42)-(21,54)
(21,55)-(21,56)
(21,60)-(21,66)
(22,19)-(22,62)
(22,36)-(22,37)
(22,19)-(22,35)
(22,20)-(22,32)
(22,33)-(22,34)
(22,38)-(22,62)
(22,43)-(22,44)
(22,39)-(22,42)
(22,45)-(22,61)
(22,46)-(22,58)
(22,59)-(22,60)
(24,6)-(28,81)
(24,10)-(24,11)
(24,6)-(24,9)
(25,8)-(28,81)
(25,26)-(25,27)
(25,9)-(25,25)
(25,10)-(25,22)
(25,23)-(25,24)
(26,11)-(28,80)
(26,16)-(26,17)
(26,12)-(26,15)
(27,14)-(28,79)
(27,32)-(27,33)
(27,15)-(27,31)
(27,16)-(27,28)
(27,29)-(27,30)
(28,17)-(28,78)
(28,22)-(28,23)
(28,18)-(28,21)
(28,24)-(28,77)
(28,42)-(28,43)
(28,25)-(28,41)
(28,26)-(28,38)
(28,39)-(28,40)
(28,44)-(28,76)
(28,49)-(28,50)
(28,45)-(28,48)
(28,51)-(28,75)
(28,69)-(28,70)
(28,52)-(28,68)
(28,53)-(28,65)
(28,66)-(28,67)
(28,71)-(28,74)
(29,17)-(29,40)
(29,22)-(29,23)
(29,17)-(29,21)
(29,24)-(29,40)
(29,25)-(29,37)
(29,38)-(29,39)
(31,6)-(31,68)
(31,13)-(31,14)
(31,6)-(31,12)
(31,15)-(31,68)
(31,33)-(31,34)
(31,16)-(31,32)
(31,17)-(31,29)
(31,30)-(31,31)
(31,35)-(31,67)
(31,40)-(31,41)
(31,36)-(31,39)
(31,42)-(31,66)
(31,60)-(31,61)
(31,43)-(31,59)
(31,44)-(31,56)
(31,57)-(31,58)
(31,62)-(31,65)
(33,6)-(35,69)
(33,15)-(33,16)
(33,6)-(33,14)
(34,8)-(35,69)
(34,26)-(34,27)
(34,9)-(34,25)
(34,10)-(34,22)
(34,23)-(34,24)
(35,11)-(35,68)
(35,33)-(35,34)
(35,12)-(35,32)
(35,13)-(35,16)
(35,17)-(35,29)
(35,30)-(35,31)
(35,35)-(35,67)
(35,40)-(35,41)
(35,36)-(35,39)
(35,42)-(35,66)
(35,60)-(35,61)
(35,43)-(35,59)
(35,44)-(35,56)
(35,57)-(35,58)
(35,62)-(35,65)
*)
