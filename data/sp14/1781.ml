
let rec clone x n = if n <= 0 then [] else x :: (clone x (n - 1));;

let rec mulByDigit i l =
  let f a x =
    match i with
    | 0 -> []
    | _ ->
        let (i,j) = x in
        let (s,t) = a in
        ((((i * j) + s) / 10), ((((i * j) + s) mod 10) :: t)) in
  let base = (0, []) in
  let args = List.combine (List.rev (0 :: l)) (clone i ((List.length l) + 1)) in
  let (_,res) = List.fold_left f base args in res;;


(* fix

let rec clone x n = if n <= 0 then [] else x :: (clone x (n - 1));;

let rec mulByDigit i l =
  let f a x =
    match i with
    | 0 -> (0, [])
    | _ ->
        let (i,j) = x in
        let (s,t) = a in
        ((((i * j) + s) / 10), ((((i * j) + s) mod 10) :: t)) in
  let base = (0, []) in
  let args = List.combine (List.rev (0 :: l)) (clone i ((List.length l) + 1)) in
  let (_,res) = List.fold_left f base args in res;;

*)

(* changed spans
(7,11)-(7,13)
*)

(* type error slice
(5,2)-(14,49)
(5,8)-(11,61)
(5,10)-(11,61)
(6,4)-(11,61)
(7,11)-(7,13)
(9,8)-(11,61)
(10,8)-(11,61)
(10,20)-(10,21)
(11,8)-(11,61)
(14,16)-(14,30)
(14,16)-(14,42)
(14,31)-(14,32)
*)

(* all spans
(2,14)-(2,65)
(2,16)-(2,65)
(2,20)-(2,65)
(2,23)-(2,29)
(2,23)-(2,24)
(2,28)-(2,29)
(2,35)-(2,37)
(2,43)-(2,65)
(2,43)-(2,44)
(2,48)-(2,65)
(2,49)-(2,54)
(2,55)-(2,56)
(2,57)-(2,64)
(2,58)-(2,59)
(2,62)-(2,63)
(4,19)-(14,49)
(4,21)-(14,49)
(5,2)-(14,49)
(5,8)-(11,61)
(5,10)-(11,61)
(6,4)-(11,61)
(6,10)-(6,11)
(7,11)-(7,13)
(9,8)-(11,61)
(9,20)-(9,21)
(10,8)-(11,61)
(10,20)-(10,21)
(11,8)-(11,61)
(11,9)-(11,29)
(11,10)-(11,23)
(11,11)-(11,18)
(11,12)-(11,13)
(11,16)-(11,17)
(11,21)-(11,22)
(11,26)-(11,28)
(11,31)-(11,60)
(11,32)-(11,54)
(11,33)-(11,46)
(11,34)-(11,41)
(11,35)-(11,36)
(11,39)-(11,40)
(11,44)-(11,45)
(11,51)-(11,53)
(11,58)-(11,59)
(12,2)-(14,49)
(12,13)-(12,20)
(12,14)-(12,15)
(12,17)-(12,19)
(13,2)-(14,49)
(13,13)-(13,77)
(13,13)-(13,25)
(13,26)-(13,45)
(13,27)-(13,35)
(13,36)-(13,44)
(13,37)-(13,38)
(13,42)-(13,43)
(13,46)-(13,77)
(13,47)-(13,52)
(13,53)-(13,54)
(13,55)-(13,76)
(13,56)-(13,71)
(13,57)-(13,68)
(13,69)-(13,70)
(13,74)-(13,75)
(14,2)-(14,49)
(14,16)-(14,42)
(14,16)-(14,30)
(14,31)-(14,32)
(14,33)-(14,37)
(14,38)-(14,42)
(14,46)-(14,49)
*)
