
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr;;

let rec eval (e,x,y) =
  match e with
  | Sine v -> sin (eval (v, x, y))
  | Cosine v -> cos (eval (v, x, y))
  | Average (v,w) -> ((eval (v, x, y)) + (eval (w, x, y))) / 2.0
  | Times (v,w) -> (eval (v, x, y)) * (eval (v, x, y))
  | Thresh (a,b,c,d) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then eval (c, x, y)
      else eval (d, x, y);;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr;;

let rec eval (e,x,y) =
  match e with
  | Sine v -> sin (eval (v, x, y))
  | Cosine v -> cos (eval (v, x, y))
  | Average (v,w) -> ((eval (v, x, y)) +. (eval (w, x, y))) /. 2.0
  | Times (v,w) -> (eval (v, x, y)) *. (eval (v, x, y))
  | Thresh (a,b,c,d) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then eval (c, x, y)
      else eval (d, x, y);;

*)

(* changed spans
(15,21)-(15,58)
(15,21)-(15,64)
(15,22)-(15,38)
(16,19)-(16,54)
*)

(* type error slice
(13,14)-(13,17)
(13,14)-(13,34)
(13,18)-(13,34)
(13,19)-(13,23)
(15,21)-(15,58)
(15,21)-(15,64)
(15,22)-(15,38)
(15,23)-(15,27)
(15,41)-(15,57)
(15,42)-(15,46)
(15,61)-(15,64)
(16,19)-(16,35)
(16,19)-(16,54)
(16,20)-(16,24)
(16,38)-(16,54)
(16,39)-(16,43)
*)

(* all spans
(11,14)-(20,25)
(12,2)-(20,25)
(12,8)-(12,9)
(13,14)-(13,34)
(13,14)-(13,17)
(13,18)-(13,34)
(13,19)-(13,23)
(13,24)-(13,33)
(13,25)-(13,26)
(13,28)-(13,29)
(13,31)-(13,32)
(14,16)-(14,36)
(14,16)-(14,19)
(14,20)-(14,36)
(14,21)-(14,25)
(14,26)-(14,35)
(14,27)-(14,28)
(14,30)-(14,31)
(14,33)-(14,34)
(15,21)-(15,64)
(15,21)-(15,58)
(15,22)-(15,38)
(15,23)-(15,27)
(15,28)-(15,37)
(15,29)-(15,30)
(15,32)-(15,33)
(15,35)-(15,36)
(15,41)-(15,57)
(15,42)-(15,46)
(15,47)-(15,56)
(15,48)-(15,49)
(15,51)-(15,52)
(15,54)-(15,55)
(15,61)-(15,64)
(16,19)-(16,54)
(16,19)-(16,35)
(16,20)-(16,24)
(16,25)-(16,34)
(16,26)-(16,27)
(16,29)-(16,30)
(16,32)-(16,33)
(16,38)-(16,54)
(16,39)-(16,43)
(16,44)-(16,53)
(16,45)-(16,46)
(16,48)-(16,49)
(16,51)-(16,52)
(18,6)-(20,25)
(18,9)-(18,44)
(18,9)-(18,25)
(18,10)-(18,14)
(18,15)-(18,24)
(18,16)-(18,17)
(18,19)-(18,20)
(18,22)-(18,23)
(18,28)-(18,44)
(18,29)-(18,33)
(18,34)-(18,43)
(18,35)-(18,36)
(18,38)-(18,39)
(18,41)-(18,42)
(19,11)-(19,25)
(19,11)-(19,15)
(19,16)-(19,25)
(19,17)-(19,18)
(19,20)-(19,21)
(19,23)-(19,24)
(20,11)-(20,25)
(20,11)-(20,15)
(20,16)-(20,25)
(20,17)-(20,18)
(20,20)-(20,21)
(20,23)-(20,24)
*)
