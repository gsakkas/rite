
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Foo of expr* expr
  | Clamp of expr* expr* expr;;

let a = (1, 2);;

let (c,d) = (1, 2);;

let pi = 4.0 *. (atan 1.0);;

let rec eval (e,x,y) =
  match e with
  | VarX  -> x
  | VarY  -> y
  | Sine a -> sin ((eval (a, x, y)) *. pi)
  | Cosine a -> cos ((eval (a, x, y)) *. pi)
  | Average (a,b) -> ((eval (a, x, y)) +. (eval (b, x, y))) /. 2.
  | Times (a,b) -> (eval (a, x, y)) *. (eval (b, x, y))
  | Thresh (a,b,c,d) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then eval (c, x, y)
      else eval (d, x, y)
  | Foo (a,b) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then 0.9 *. (eval (a, x, y))
      else (eval 0.1) *. (a, x, y)
  | Clamp (a,b,c) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then eval (b, x, y)
      else
        if (eval (a, x, y)) > (eval (c, x, y))
        then eval (c, x, y)
        else eval (a, x, y);;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Foo of expr* expr
  | Clamp of expr* expr* expr;;

let a = (1, 2);;

let (c,d) = (1, 2);;

let pi = 4.0 *. (atan 1.0);;

let rec eval (e,x,y) =
  match e with
  | VarX  -> x
  | VarY  -> y
  | Sine a -> sin ((eval (a, x, y)) *. pi)
  | Cosine a -> cos ((eval (a, x, y)) *. pi)
  | Average (a,b) -> ((eval (a, x, y)) +. (eval (b, x, y))) /. 2.
  | Times (a,b) -> (eval (a, x, y)) *. (eval (b, x, y))
  | Thresh (a,b,c,d) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then eval (c, x, y)
      else eval (d, x, y)
  | Foo (a,b) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then 0.9 *. (eval (a, x, y))
      else 0.1 *. (eval (a, x, y))
  | Clamp (a,b,c) ->
      if (eval (a, x, y)) < (eval (b, x, y))
      then eval (b, x, y)
      else
        if (eval (a, x, y)) > (eval (c, x, y))
        then eval (c, x, y)
        else eval (a, x, y);;

*)

(* changed spans
(34,11)-(34,21)
(34,17)-(34,20)
*)

(* type error slice
(23,19)-(23,35)
(23,20)-(23,24)
(23,25)-(23,34)
(34,11)-(34,21)
(34,11)-(34,34)
(34,12)-(34,16)
(34,17)-(34,20)
(34,25)-(34,34)
*)

(* all spans
(13,8)-(13,14)
(13,9)-(13,10)
(13,12)-(13,13)
(15,12)-(15,18)
(15,13)-(15,14)
(15,16)-(15,17)
(17,9)-(17,26)
(17,9)-(17,12)
(17,16)-(17,26)
(17,17)-(17,21)
(17,22)-(17,25)
(19,14)-(41,27)
(20,2)-(41,27)
(20,8)-(20,9)
(21,13)-(21,14)
(22,13)-(22,14)
(23,14)-(23,42)
(23,14)-(23,17)
(23,18)-(23,42)
(23,19)-(23,35)
(23,20)-(23,24)
(23,25)-(23,34)
(23,26)-(23,27)
(23,29)-(23,30)
(23,32)-(23,33)
(23,39)-(23,41)
(24,16)-(24,44)
(24,16)-(24,19)
(24,20)-(24,44)
(24,21)-(24,37)
(24,22)-(24,26)
(24,27)-(24,36)
(24,28)-(24,29)
(24,31)-(24,32)
(24,34)-(24,35)
(24,41)-(24,43)
(25,21)-(25,65)
(25,21)-(25,59)
(25,22)-(25,38)
(25,23)-(25,27)
(25,28)-(25,37)
(25,29)-(25,30)
(25,32)-(25,33)
(25,35)-(25,36)
(25,42)-(25,58)
(25,43)-(25,47)
(25,48)-(25,57)
(25,49)-(25,50)
(25,52)-(25,53)
(25,55)-(25,56)
(25,63)-(25,65)
(26,19)-(26,55)
(26,19)-(26,35)
(26,20)-(26,24)
(26,25)-(26,34)
(26,26)-(26,27)
(26,29)-(26,30)
(26,32)-(26,33)
(26,39)-(26,55)
(26,40)-(26,44)
(26,45)-(26,54)
(26,46)-(26,47)
(26,49)-(26,50)
(26,52)-(26,53)
(28,6)-(30,25)
(28,9)-(28,44)
(28,9)-(28,25)
(28,10)-(28,14)
(28,15)-(28,24)
(28,16)-(28,17)
(28,19)-(28,20)
(28,22)-(28,23)
(28,28)-(28,44)
(28,29)-(28,33)
(28,34)-(28,43)
(28,35)-(28,36)
(28,38)-(28,39)
(28,41)-(28,42)
(29,11)-(29,25)
(29,11)-(29,15)
(29,16)-(29,25)
(29,17)-(29,18)
(29,20)-(29,21)
(29,23)-(29,24)
(30,11)-(30,25)
(30,11)-(30,15)
(30,16)-(30,25)
(30,17)-(30,18)
(30,20)-(30,21)
(30,23)-(30,24)
(32,6)-(34,34)
(32,9)-(32,44)
(32,9)-(32,25)
(32,10)-(32,14)
(32,15)-(32,24)
(32,16)-(32,17)
(32,19)-(32,20)
(32,22)-(32,23)
(32,28)-(32,44)
(32,29)-(32,33)
(32,34)-(32,43)
(32,35)-(32,36)
(32,38)-(32,39)
(32,41)-(32,42)
(33,11)-(33,34)
(33,11)-(33,14)
(33,18)-(33,34)
(33,19)-(33,23)
(33,24)-(33,33)
(33,25)-(33,26)
(33,28)-(33,29)
(33,31)-(33,32)
(34,11)-(34,34)
(34,11)-(34,21)
(34,12)-(34,16)
(34,17)-(34,20)
(34,25)-(34,34)
(34,26)-(34,27)
(34,29)-(34,30)
(34,32)-(34,33)
(36,6)-(41,27)
(36,9)-(36,44)
(36,9)-(36,25)
(36,10)-(36,14)
(36,15)-(36,24)
(36,16)-(36,17)
(36,19)-(36,20)
(36,22)-(36,23)
(36,28)-(36,44)
(36,29)-(36,33)
(36,34)-(36,43)
(36,35)-(36,36)
(36,38)-(36,39)
(36,41)-(36,42)
(37,11)-(37,25)
(37,11)-(37,15)
(37,16)-(37,25)
(37,17)-(37,18)
(37,20)-(37,21)
(37,23)-(37,24)
(39,8)-(41,27)
(39,11)-(39,46)
(39,11)-(39,27)
(39,12)-(39,16)
(39,17)-(39,26)
(39,18)-(39,19)
(39,21)-(39,22)
(39,24)-(39,25)
(39,30)-(39,46)
(39,31)-(39,35)
(39,36)-(39,45)
(39,37)-(39,38)
(39,40)-(39,41)
(39,43)-(39,44)
(40,13)-(40,27)
(40,13)-(40,17)
(40,18)-(40,27)
(40,19)-(40,20)
(40,22)-(40,23)
(40,25)-(40,26)
(41,13)-(41,27)
(41,13)-(41,17)
(41,18)-(41,27)
(41,19)-(41,20)
(41,22)-(41,23)
(41,25)-(41,26)
*)
