
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Poly of expr* expr* expr
  | Tan of expr;;

let rec exprToString e =
  let expr = exprToString in
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine a -> "sin(pi*" ^ ((expr a) ^ ")")
  | Cosine a -> "cos(pi*" ^ ((expr a) ^ ")")
  | Average (a,b) -> "((" ^ ((expr a) ^ ("+" ^ ((expr b) ^ ")/2)")))
  | Times (a,b) -> (expr a) ^ ("*" ^ (expr b))
  | Thresh (a,b,c,d) ->
      "(" ^
        ((expr a) ^
           ("<" ^ ((expr b) ^ ("?" ^ ((expr c) ^ (":" ^ ((expr d) ^ ")")))))))
  | Poly (a,b,c) ->
      "(" ^
        ((expr a) ^
           ("*" ^ ((expr a) ^ ("+" ^ ((expr b) ^ ("*" ^ ((expr c) ^ ")")))))))
  | Tan a -> "sin(pi*" ^ ((expr a) ^ (")/cos(pi*" ^ ((expr a) ")")));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Poly of expr* expr* expr
  | Tan of expr;;

let rec exprToString e =
  let expr = exprToString in
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine a -> "sin(pi*" ^ ((expr a) ^ ")")
  | Cosine a -> "cos(pi*" ^ ((expr a) ^ ")")
  | Average (a,b) -> "((" ^ ((expr a) ^ ("+" ^ ((expr b) ^ ")/2)")))
  | Times (a,b) -> (expr a) ^ ("*" ^ (expr b))
  | Thresh (a,b,c,d) ->
      "(" ^
        ((expr a) ^
           ("<" ^ ((expr b) ^ ("?" ^ ((expr c) ^ (":" ^ ((expr d) ^ ")")))))))
  | Poly (a,b,c) ->
      "(" ^
        ((expr a) ^
           ("*" ^ ((expr a) ^ ("+" ^ ((expr b) ^ ("*" ^ ((expr c) ^ ")")))))))
  | Tan a -> "sin(pi*" ^ ((expr a) ^ (")/cos(pi*" ^ ((expr a) ^ ")")));;

*)

(* changed spans
(30,52)-(30,66)
(30,53)-(30,61)
*)

(* type error slice
(18,26)-(18,42)
(18,27)-(18,35)
(18,28)-(18,32)
(18,36)-(18,37)
(30,52)-(30,66)
(30,53)-(30,61)
(30,54)-(30,58)
*)

(* all spans
(13,21)-(30,68)
(14,2)-(30,68)
(14,13)-(14,25)
(15,2)-(30,68)
(15,8)-(15,9)
(16,13)-(16,16)
(17,13)-(17,16)
(18,14)-(18,42)
(18,24)-(18,25)
(18,14)-(18,23)
(18,26)-(18,42)
(18,36)-(18,37)
(18,27)-(18,35)
(18,28)-(18,32)
(18,33)-(18,34)
(18,38)-(18,41)
(19,16)-(19,44)
(19,26)-(19,27)
(19,16)-(19,25)
(19,28)-(19,44)
(19,38)-(19,39)
(19,29)-(19,37)
(19,30)-(19,34)
(19,35)-(19,36)
(19,40)-(19,43)
(20,21)-(20,68)
(20,26)-(20,27)
(20,21)-(20,25)
(20,28)-(20,68)
(20,38)-(20,39)
(20,29)-(20,37)
(20,30)-(20,34)
(20,35)-(20,36)
(20,40)-(20,67)
(20,45)-(20,46)
(20,41)-(20,44)
(20,47)-(20,66)
(20,57)-(20,58)
(20,48)-(20,56)
(20,49)-(20,53)
(20,54)-(20,55)
(20,59)-(20,65)
(21,19)-(21,46)
(21,28)-(21,29)
(21,19)-(21,27)
(21,20)-(21,24)
(21,25)-(21,26)
(21,30)-(21,46)
(21,35)-(21,36)
(21,31)-(21,34)
(21,37)-(21,45)
(21,38)-(21,42)
(21,43)-(21,44)
(23,6)-(25,78)
(23,10)-(23,11)
(23,6)-(23,9)
(24,8)-(25,78)
(24,18)-(24,19)
(24,9)-(24,17)
(24,10)-(24,14)
(24,15)-(24,16)
(25,11)-(25,77)
(25,16)-(25,17)
(25,12)-(25,15)
(25,18)-(25,76)
(25,28)-(25,29)
(25,19)-(25,27)
(25,20)-(25,24)
(25,25)-(25,26)
(25,30)-(25,75)
(25,35)-(25,36)
(25,31)-(25,34)
(25,37)-(25,74)
(25,47)-(25,48)
(25,38)-(25,46)
(25,39)-(25,43)
(25,44)-(25,45)
(25,49)-(25,73)
(25,54)-(25,55)
(25,50)-(25,53)
(25,56)-(25,72)
(25,66)-(25,67)
(25,57)-(25,65)
(25,58)-(25,62)
(25,63)-(25,64)
(25,68)-(25,71)
(27,6)-(29,78)
(27,10)-(27,11)
(27,6)-(27,9)
(28,8)-(29,78)
(28,18)-(28,19)
(28,9)-(28,17)
(28,10)-(28,14)
(28,15)-(28,16)
(29,11)-(29,77)
(29,16)-(29,17)
(29,12)-(29,15)
(29,18)-(29,76)
(29,28)-(29,29)
(29,19)-(29,27)
(29,20)-(29,24)
(29,25)-(29,26)
(29,30)-(29,75)
(29,35)-(29,36)
(29,31)-(29,34)
(29,37)-(29,74)
(29,47)-(29,48)
(29,38)-(29,46)
(29,39)-(29,43)
(29,44)-(29,45)
(29,49)-(29,73)
(29,54)-(29,55)
(29,50)-(29,53)
(29,56)-(29,72)
(29,66)-(29,67)
(29,57)-(29,65)
(29,58)-(29,62)
(29,63)-(29,64)
(29,68)-(29,71)
(30,13)-(30,68)
(30,23)-(30,24)
(30,13)-(30,22)
(30,25)-(30,68)
(30,35)-(30,36)
(30,26)-(30,34)
(30,27)-(30,31)
(30,32)-(30,33)
(30,37)-(30,67)
(30,50)-(30,51)
(30,38)-(30,49)
(30,52)-(30,66)
(30,53)-(30,61)
(30,54)-(30,58)
(30,59)-(30,60)
(30,62)-(30,65)
*)
